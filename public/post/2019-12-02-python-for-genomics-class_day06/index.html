<!DOCTYPE html>
<!-- This site was created with Wowchemy. https://www.wowchemy.com -->
<!-- Last Published: August 10, 2023 --><html lang="en-us" >


<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  
  
    <meta name="generator" content="Wowchemy 5.7.0 for Hugo" />
  

  
  












  
  










  







  
  
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Bruno+Ace&family=Limelight&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Bruno+Ace&family=Limelight&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" media="print" onload="this.media='all'">
    
  

  
  

  
  
    
    <script src="/js/mathjax-config.js"></script>
  

  

  <link rel="stylesheet" href="/css/vendor-bundle.min.047268c6dd09ad74ba54a0ba71837064.css" media="print" onload="this.media='all'">

  
  
  
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.2/css/academicons.min.css" integrity="sha512-KlJCpRsLf+KKu2VQa5vmRuClRFjxc5lXO03ixZt82HZUk41+1I0bD8KBSA0fY290ayMfWYI9udIqeOWSu1/uZg==" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    
    
    
    
      
      
    
    
    

    
    
    

    

    
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      
      

      
      

      
    
      
      

      
      

      
    
  

  
  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.00f70589ff95c2db8722b74912195f3f.css" />

  
  
  

  
  
  
  
  
  
  
    
    
    <link rel="stylesheet" href="/css/libs/chroma/github-light.min.css" title="hl-light" media="print" onload="this.media='all'" >
    <link rel="stylesheet" href="/css/libs/chroma/dracula.min.css" title="hl-dark" media="print" onload="this.media='all'" disabled>
  

  
  


























  
  
  






  <meta name="author" content="Xiaotao Shen" />





  

<meta name="description" content="Python for genomics day 06" />



<link rel="alternate" hreflang="en-us" href="https://jaspershen.github.io/post/2019-12-02-python-for-genomics-class_day06/" />
<link rel="canonical" href="https://jaspershen.github.io/post/2019-12-02-python-for-genomics-class_day06/" />



  <link rel="manifest" href="/manifest.webmanifest" />



<link rel="icon" type="image/png" href="/media/icon_hu805a85e690e4f2727bf7d5f685d888f7_86836_32x32_fill_lanczos_center_3.png" />
<link rel="apple-touch-icon" type="image/png" href="/media/icon_hu805a85e690e4f2727bf7d5f685d888f7_86836_180x180_fill_lanczos_center_3.png" />

<meta name="theme-color" content="#007C48" />










  






<meta property="twitter:card" content="summary_large_image" />

  <meta property="twitter:site" content="@wowchemy" />
  <meta property="twitter:creator" content="@wowchemy" />
<meta property="twitter:image" content="https://jaspershen.github.io/post/2019-12-02-python-for-genomics-class_day06/featured.png" />
<meta property="og:site_name" content="Xiaotao Shen" />
<meta property="og:url" content="https://jaspershen.github.io/post/2019-12-02-python-for-genomics-class_day06/" />
<meta property="og:title" content="Python for genomics day 06 | Xiaotao Shen" />
<meta property="og:description" content="Python for genomics day 06" /><meta property="og:image" content="https://jaspershen.github.io/post/2019-12-02-python-for-genomics-class_day06/featured.png" /><meta property="og:locale" content="en-us" />

  
    <meta
      property="article:published_time"
      content="2019-12-07T00:00:00&#43;00:00"
    />
  
  
    <meta property="article:modified_time" content="2019-12-07T00:00:00&#43;00:00">
  






    






  




<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://jaspershen.github.io/post/2019-12-02-python-for-genomics-class_day06/"
  },
  "headline": "Python for genomics day 06",
  
  "image": [
    "https://jaspershen.github.io/post/2019-12-02-python-for-genomics-class_day06/featured.png"
  ],
  
  "datePublished": "2019-12-07T00:00:00Z",
  "dateModified": "2019-12-07T00:00:00Z",
  
  "author": {
    "@type": "Person",
    "name": "Xiaotao Shen"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "Xiaotao Shen",
    "logo": {
      "@type": "ImageObject",
      "url": "https://jaspershen.github.io/media/icon_hu805a85e690e4f2727bf7d5f685d888f7_86836_192x192_fill_lanczos_center_3.png"
    }
  },
  "description": "Python for genomics day 06"
}
</script>

  

  




  
  
  

  
  

  


  
  <title>Python for genomics day 06 | Xiaotao Shen</title>

  
  
  
  











</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper   " data-wc-page-id="3e344e9a1786be53d13ae92063b98fe0" >

  
  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.c51bb6301bb2be5edd35b3630c50ed3a.js"></script>

  


<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="Close"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control"
        aria-label="Search...">
        
      </div>

      
      

      

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header header--fixed">
  
  
  
  
  












<header>
  <nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
    <div class="container-xl">

      
      <div class="d-none d-lg-inline-flex">
        <a class="navbar-brand" href="/">Xiaotao Shen</a>
      </div>
      

      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar-content" aria-controls="navbar-content" aria-expanded="false" aria-label="Toggle navigation">
      <span><i class="fas fa-bars"></i></span>
      </button>
      

      
      <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
        <a class="navbar-brand" href="/">Xiaotao Shen</a>
      </div>
      

      
      
      <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

        
        <ul class="navbar-nav d-md-inline-flex">
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#about"><span>ğŸ  About</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#posts"><span>ğŸ“– Posts</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#projects"><span>ğŸ’» Projects</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#talks"><span>ğŸ—£ï¸ Talks</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#featured"><span>ğŸ—ï¸ Publications</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#contact"><span>ğŸ“¥ Contact</span></a>
          </li>

          
          

        

          
        </ul>
      </div>

      <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

        
        
          
            
            <li class="nav-item d-none d-lg-inline-flex">
              <a class="nav-link" href="https://twitter.com/GeorgeCushen" target="_blank" rel="noopener" aria-label="github">
                <i class="fab fa-github" aria-hidden="true"></i>
              </a>
            </li>
          
        

        
        
        
        <li class="nav-item">
          <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        
        
        
        <li class="nav-item dropdown theme-dropdown">
          <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true" aria-label="Display preferences">
            <i class="fas fa-moon" aria-hidden="true"></i>
          </a>
          <div class="dropdown-menu">
            <a href="#" class="dropdown-item js-set-theme-light">
              <span>Light</span>
            </a>
            <a href="#" class="dropdown-item js-set-theme-dark">
              <span>Dark</span>
            </a>
            <a href="#" class="dropdown-item js-set-theme-auto">
              <span>Automatic</span>
            </a>
          </div>
        </li>
        

        
        

      </ul>

    </div>
  </nav>
</header>


  </div>

  <div class="page-body">
    
    
    

    <article class="article">

  






















  
  


<div class="article-container pt-3">
  <h1>Python for genomics day 06</h1>

  
  <p class="page-subtitle">Python for genomics day 06</p>
  

  


<div class="article-metadata">

  
  
  
  
  <div>
    

  <span class="author-highlighted">
      Xiaotao Shen</span>
  </div>
  
  

  
  <span class="article-date">
    
    
      
    
    Dec 7, 2019
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    16 min read
  </span>
  

  
  
  
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="/category/python/">Python</a></span>
  

</div>

  





</div>


<div class="article-header article-container featured-image-wrapper mt-4 mb-4" style="max-width: 720px; max-height: 407px;">
  <div style="position: relative">
    <img src="/post/2019-12-02-python-for-genomics-class_day06/featured_hub2df554e8ed229a2f4f490aa58d08812_709133_720x2500_fit_q75_h2_lanczos_3.webp" width="720" height="407" alt="" class="featured-image">
    
  </div>
</div>



  <div class="article-container">

    <div class="article-style">
      <details class="toc-inpage d-print-none  " open>
  <summary class="font-weight-bold">Table of Contents</summary>
  <nav id="TableOfContents">
  <ul>
    <li><a href="#osæ¨¡å—çš„å¸¸ç”¨å‘½ä»¤">osæ¨¡å—çš„å¸¸ç”¨å‘½ä»¤</a></li>
  </ul>

  <ul>
    <li><a href="#gffgtfæ ¼å¼æ–‡ä»¶">GFF/GTFæ ¼å¼æ–‡ä»¶</a></li>
  </ul>

  <ul>
    <li><a href="#åŠ è½½library">åŠ è½½library</a>
      <ul>
        <li><a href="#gzipåŒ…">gzipåŒ…</a></li>
        <li><a href="#osåŒ…"><code>os</code>åŒ…</a></li>
        <li><a href="#randomåŒ…"><code>random</code>åŒ…</a></li>
        <li><a href="#ä¸åŒçš„æ–¹æ³•å–naviageä¸€ä¸ªæ–‡ä»¶file">ä¸åŒçš„æ–¹æ³•å–naviageä¸€ä¸ªæ–‡ä»¶(file)</a></li>
        <li><a href="#ä»urlè¯»å–æ•°æ®æ–‡ä»¶">ä»urlè¯»å–æ•°æ®æ–‡ä»¶</a></li>
      </ul>
    </li>
    <li><a href="#åˆ—è¡¨æ¨å¯¼å¼å’Œmapå‡½æ•°">åˆ—è¡¨æ¨å¯¼å¼å’Œmap()å‡½æ•°</a>
      <ul>
        <li><a href="#1-ä½¿ç”¨å¾ªç¯">1. ä½¿ç”¨å¾ªç¯</a></li>
        <li><a href="#2-ä½¿ç”¨åˆ—è¡¨æ¨å¯¼å¼">2. ä½¿ç”¨åˆ—è¡¨æ¨å¯¼å¼</a></li>
        <li><a href="#ä½¿ç”¨mapå‡½æ•°">ä½¿ç”¨<code>map()</code>å‡½æ•°</a></li>
      </ul>
    </li>
  </ul>
</nav>
</details>
<p>ä¸»è¦ä»‹ç»äº†å‡ ä¸ªåŸºç¡€çš„æ¨¡å—,å‡½æ•°,ä»¥åŠå¦‚ä½•åˆ›å»ºè‡ªå®šä¹‰å‡½æ•°.</p>
<h1 id="osæ¨¡å—os-module">osæ¨¡å—(os module)</h1>
<p>osæ¨¡å—æ˜¯ç”¨äºè·¯å¾„ç®¡ç†,æ–‡ä»¶å¤¹ç®¡ç†ç­‰çš„æ¨¡å—.</p>
<h2 id="osæ¨¡å—çš„å¸¸ç”¨å‘½ä»¤">osæ¨¡å—çš„å¸¸ç”¨å‘½ä»¤</h2>
<table>
<thead>
<tr>
<th>Function</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>os.mkdir()</code></td>
<td>åˆ›å»ºæ–°çš„æ–‡ä»¶å¤¹</td>
</tr>
<tr>
<td><code>os.remove()</code></td>
<td>åˆ é™¤ä¸€ä¸ªæ–‡ä»¶æˆ–è€…æ–‡ä»¶å¤¹</td>
</tr>
<tr>
<td><code>os.chdir()</code></td>
<td>æ›´æ”¹å·¥ä½œè·¯å¾„</td>
</tr>
<tr>
<td><code>os.rmdir()</code></td>
<td>åˆ é™¤ä¸€ä¸ªæ–‡ä»¶å¤¹,ä½†æ˜¯è¦æ±‚è¯¥æ–‡ä»¶å¤¹å¿…é¡»ä¸ºç©º</td>
</tr>
<tr>
<td><code>os.getcwd()</code></td>
<td>è·å–å½“å‰å·¥ä½œè·¯å¾„</td>
</tr>
<tr>
<td><code>os.listdir()</code></td>
<td>åˆ—å‡ºå½“å‰è·¯å¾„ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åŠæ–‡ä»¶å¤¹</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span> <span class="k">as</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl"><span class="c1"># è·å–å½“å‰çš„å·¥ä½œè·¯å¾„</span>
</span></span><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>D:\my github\shen\content\en\post\2019-12-02-python-for-genomics-class_day06
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">#åˆ—å‡ºå½“å‰è·¯å¾„ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å’Œæ–‡ä»¶å¤¹</span>
</span></span><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>['.ipynb_checkpoints', 'index.ipynb', 'Practice06-Veronica.ipynb', 'sample.txt', 'sample.txt.gz']
</code></pre>
<p>å¾—åˆ°çš„ç»“æœæ˜¯ä¸€ä¸ªåˆ—è¡¨.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">#åˆ›å»ºæ–°çš„æ–‡ä»¶å¤¹</span>
</span></span><span class="line"><span class="cl"><span class="n">dir_name</span> <span class="o">=</span> <span class="s1">&#39;new_dir_123456&#39;</span>
</span></span><span class="line"><span class="cl"><span class="k">try</span><span class="p">:</span> 
</span></span><span class="line"><span class="cl">    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">dir_name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">except</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;This file already exists&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#è¿™é‡Œå†æ¬¡ç†Ÿæ‚‰ä¸€ä¸‹å¼‚å¸¸æ•æ‰è¯­æ³•</span>
</span></span><span class="line"><span class="cl"><span class="c1"># è·ŸRä¸ä¸€æ ·,Ré‡Œé¢å¦‚æœå·²æœ‰è·¯å¾„,å¹¶ä¸ä¼šæŠ¥é”™,åªä¼šç»™å‡ºwarning</span>
</span></span><span class="line"><span class="cl"><span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">dir_name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">except</span> <span class="ne">FileExistsError</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Directory not created. Directory&#39;</span><span class="p">,</span> <span class="n">dir_name</span><span class="p">,</span> <span class="s1">&#39;exists.&#39;</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>This file already exists
Directory not created. Directory new_dir_123456 exists.
</code></pre>
<p>éœ€è¦æ³¨æ„çš„æ˜¯,å¦‚æœå½“å‰è·¯å¾„ä¸­å·²ç»å­˜åœ¨äº†è¦åˆ›å»ºçš„æ–‡ä»¶å¤¹,åˆ™ä¼šæŠ¥é”™,è·ŸRä¸­ä¸åŒ,Råªæ˜¯ä¼šç»™å‡ºwarning.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>['.ipynb_checkpoints', 'index.ipynb', 'new_dir_123456', 'Practice06-Veronica.ipynb', 'sample.txt', 'sample.txt.gz']
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s1">&#39;new_dir_123456&#39;</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>None
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">dir_name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No such file or directory&#39;</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>D:\my github\shen\content\en\post\2019-12-02-python-for-genomics-class_day06\new_dir_123456
No such file or directory
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>D:\my github\shen\content\en\post\2019-12-02-python-for-genomics-class_day06\new_dir_123456
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>[]
</code></pre>
<p>å°†ä¸€ä¸ªç¤ºä¾‹æ•°æ®å†™å…¥åˆ°æ–°åˆ›å»ºçš„æ–‡ä»¶å¤¹ä¸­.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Writing test file in new_dir_123456, testing.txt&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;testing.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">TEST</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">TEST</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;testing&#39;</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>Writing test file in new_dir_123456, testing.txt
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>['testing.txt']
</code></pre>
<p>åˆ é™¤æ‰æ–°åˆ›å»ºçš„å®ä¾‹æ–‡ä»¶æ•°æ®,æ³¨æ„,å¦‚æœæ²¡æœ‰è¯¥æ–‡ä»¶,ä¼šæŠ¥é”™.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;testing.txt&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;No this file is found.&#34;</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>None
</code></pre>
<p>åˆ é™¤æ‰æ–°åˆ›å»ºçš„æ–‡ä»¶å¤¹.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">os</span><span class="o">.</span><span class="n">rmdir</span><span class="p">(</span><span class="s1">&#39;new_dir_123456&#39;</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>D:\my github\shen\content\en\post\2019-12-02-python-for-genomics-class_day06
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>['.ipynb_checkpoints', 'index.ipynb', 'Practice06-Veronica.ipynb', 'sample.txt', 'sample.txt.gz']
</code></pre>
<h1 id="gzip--urllibæ¨¡å—">gzip &amp; urllibæ¨¡å—</h1>
<p><code>gzip</code>æ¨¡å—æ˜¯ç”¨æ¥å¤„ç†å‹ç¼©æ–‡ä»¶çš„.<code>urllib</code>æ¨¡å—æ˜¯ç”¨æ¥å¤„ç†ç½‘ç»œæ–‡ä»¶çš„.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># Module for URL, interacting with the web</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">urllib.request</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Module for reading and writing the compressed file format, gzip</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">gzip</span>
</span></span></code></pre></div><h2 id="gffgtfæ ¼å¼æ–‡ä»¶">GFF/GTFæ ¼å¼æ–‡ä»¶</h2>
<p>ensEMBL GFF format:</p>
<p>å¯ä»¥å‚è€ƒä¸‹é¢è¿æ¥.https://uswest.ensembl.org/info/website/upload/gff.html</p>
<p>æ¯è¡Œä¸€å…±æœ‰9ä¸ªå…ƒç´ ,æ¯ä¸ªå…ƒç´ åå­—å¦‚ä¸‹:</p>
<p>SEQNAME = 0
SOURCE = 1
FEATURE = 2
START = 3
END = 4
SCORE = 5
STRAND = 6
FRAME = 7
ATTRIBUTE = 8</p>
<p>FTP ensEMBL downloads site: <a href="https://uswest.ensembl.org/info/data/ftp/index.html" target="_blank" rel="noopener">https://uswest.ensembl.org/info/data/ftp/index.html</a></p>
<p>æˆ‘ä»¬å°†æ¯ä¸ªå…ƒç´ çš„indexèµ‹å€¼ç»™å…¶ä»£è¡¨çš„å­—ç¬¦å˜é‡.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">SEQNAME</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">SOURCE</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="n">FEATURE</span> <span class="o">=</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl"><span class="n">START</span> <span class="o">=</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl"><span class="n">END</span> <span class="o">=</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="n">SCORE</span> <span class="o">=</span> <span class="mi">5</span>
</span></span><span class="line"><span class="cl"><span class="n">STRAND</span> <span class="o">=</span> <span class="mi">6</span>
</span></span><span class="line"><span class="cl"><span class="n">FRAME</span> <span class="o">=</span> <span class="mi">7</span>
</span></span><span class="line"><span class="cl"><span class="n">ATTRIBUTE</span> <span class="o">=</span> <span class="mi">8</span>
</span></span></code></pre></div><p>å¦å¤–ä»¥å„ç§æ ¼å¼å«GFF3,ç›¸å¯¹æ¥è¯´å®¹æ˜“è§£æä¸€äº›.å‚è€ƒä¸‹é¢è¿æ¥:</p>
<p><a href="ftp://ftp.ensembl.org/pub/release-98/gff3/homo_sapiens">ftp://ftp.ensembl.org/pub/release-98/gff3/homo_sapiens</a></p>
<p>ä¸¾ä¸ªä¾‹å­</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">GTF_URL</span> <span class="o">=</span> <span class="s1">&#39;https://web.stanford.edu/class/gene211/handouts/Homo_sapiens.GRCh38.chr21-truncated.gtf.gz&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">GFF3_URL</span> <span class="o">=</span> <span class="s1">&#39;https://web.stanford.edu/class/gene211/handouts/Homo_sapiens.GRCh38.98.chr21-partial.gff3.gz&#39;</span>
</span></span></code></pre></div><p>é¦–å…ˆè¯»å–GTFæ ¼å¼çš„æ•°æ®</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">#é¦–å…ˆä½¿ç”¨urllibæ¨¡å—å°†æ–‡ä»¶åœ°å€è¿›è¡Œè§£æ</span>
</span></span><span class="line"><span class="cl"><span class="n">response</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">GTF_URL</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">line_count</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="c1">##ä½¿ç”¨gzipæ¨¡å—çš„openå‡½æ•°æ‰“å¼€æ–‡ä»¶</span>
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="n">gzip</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="s1">&#39;rt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">inFile</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">inFile</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># skip file comment lines</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">continue</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">line_count</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="n">line_count</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span></code></pre></div><pre><code>['21', 'havana', 'gene', '5011799', '5017145', '.', '+', '.', 'gene_id &quot;ENSG00000279493&quot;; gene_version &quot;1&quot;; gene_name &quot;FP565260.4&quot;; gene_source &quot;havana&quot;; gene_biotype &quot;protein_coding&quot;;']
9
</code></pre>
<p>åªæ‰“å°äº†ä¸€è¡Œ,å…ˆæ¥çœ‹ä¸€ä¸‹è¿™ä¸ªæ–‡ä»¶çš„æ ¼å¼.æ¯è¡Œéƒ½æ˜¯ä¸€ä¸ªstr.ç„¶åæ˜¯<code>\t</code>åˆ†å‰²ç¬¦è¿›è¡Œåˆ†å‰².åˆ†å‰²ä¹‹åå˜ä¸ºlist,ç„¶åæ¯ä¸ªlistæœ‰9ä¸ªå…ƒç´ .</p>
<p>ä¸‹é¢æˆ‘ä»¬åœ¨æ¯”è¾ƒä¸€ä¸‹GTFå’ŒGFF3æ ¼å¼æ•°æ®çš„å·®å¼‚.</p>
<p>è¯»å–GFF3æ ¼å¼æ•°æ®</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># Just to compare GTF and GFF3. The difference is in the ATTRIBUTE column (index 8)</span>
</span></span><span class="line"><span class="cl"><span class="n">response</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">GFF3_URL</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">line_count</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="n">gzip</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="s1">&#39;rt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">inFile</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">inFile</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># skip file comment lines</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">continue</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">line_count</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="n">line_count</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span></code></pre></div><pre><code>['21', 'Ensembl', 'chromosome', '1', '46709983', '.', '.', '.', 'ID=chromosome:21;Alias=CM000683.2,chr21,NC_000021.9']
9
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">response</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">GTF_URL</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">genes</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl"><span class="n">attribute_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;gene_id&#39;</span><span class="p">,</span> <span class="s1">&#39;gene_name&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="n">gzip</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="s1">&#39;rt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">inFile</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">inFile</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># skip file comment lines</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">continue</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># split line into columns that are separated by TAB </span>
</span></span><span class="line"><span class="cl">        <span class="n">column</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># manipulate column #8, attributes</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">column</span><span class="p">[</span><span class="n">FEATURE</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;gene&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># starting ATTRIBUTE string</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># gene_id &#34;ENSG00000279493&#34;; gene_version &#34;1&#34;; gene_name &#34;FP565260.4&#34;;</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># remove semi-colon from right</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># gene_id &#34;ENSG00000279493&#34;; gene_version &#34;1&#34;; gene_name &#34;FP565260.4&#34;            </span>
</span></span><span class="line"><span class="cl">            <span class="n">column</span><span class="p">[</span><span class="n">ATTRIBUTE</span><span class="p">]</span> <span class="o">=</span> <span class="n">column</span><span class="p">[</span><span class="n">ATTRIBUTE</span><span class="p">]</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># replace semi-colon space with just semi-colon, and delete double-quotes</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># then split on semi-colon</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># [&#39;gene_id ENSG00000279493&#39;, &#39;gene_version 1&#39;, &#39;gene_name FP565260.4&#39;]</span>
</span></span><span class="line"><span class="cl">            <span class="n">attribute</span> <span class="o">=</span> <span class="n">column</span><span class="p">[</span><span class="n">ATTRIBUTE</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;; &#39;</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&#34;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">attribute</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;gene_id&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">gene_id</span> <span class="o">=</span> <span class="n">value</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;gene_name&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">gene_name</span> <span class="o">=</span> <span class="n">value</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;gene_biotype&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">gene_biotype</span> <span class="o">=</span> <span class="n">value</span>
</span></span><span class="line"><span class="cl">            <span class="n">genes</span><span class="p">[</span><span class="n">gene_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;gene_id&#39;</span><span class="p">:</span> <span class="n">gene_id</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                <span class="s1">&#39;chromsome&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">column</span><span class="p">[</span><span class="n">SEQNAME</span><span class="p">]),</span>
</span></span><span class="line"><span class="cl">                                <span class="s1">&#39;start&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">column</span><span class="p">[</span><span class="n">START</span><span class="p">]),</span>
</span></span><span class="line"><span class="cl">                                <span class="s1">&#39;end&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">column</span><span class="p">[</span><span class="n">END</span><span class="p">]),</span>
</span></span><span class="line"><span class="cl">                                <span class="s1">&#39;biotype&#39;</span><span class="p">:</span> <span class="n">gene_biotype</span>
</span></span><span class="line"><span class="cl">                                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">gene_name</span> <span class="o">==</span> <span class="s1">&#39;GATD3B&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="nb">print</span><span class="p">(</span><span class="n">genes</span><span class="p">[</span><span class="s1">&#39;GATD3B&#39;</span><span class="p">])</span>
</span></span></code></pre></div><pre><code>{'gene_id': 'ENSG00000280071', 'chromsome': 21, 'start': 5079294, 'end': 5128413, 'biotype': 'protein_coding'}
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">genes</span>
</span></span></code></pre></div><pre><code>{'FP565260.4': {'gene_id': 'ENSG00000279493',
  'chromsome': 21,
  'start': 5011799,
  'end': 5017145,
  'biotype': 'protein_coding'},
 'FP565260.3': {'gene_id': 'ENSG00000277117',
  'chromsome': 21,
  'start': 5022493,
  'end': 5040666,
  'biotype': 'protein_coding'},
 'FP565260.5': {'gene_id': 'ENSG00000279687',
  'chromsome': 21,
  'start': 5073458,
  'end': 5087867,
  'biotype': 'lncRNA'},
 'GATD3B': {'gene_id': 'ENSG00000280071',
  'chromsome': 21,
  'start': 5079294,
  'end': 5128413,
  'biotype': 'protein_coding'},
 'FP565260.2': {'gene_id': 'ENSG00000276612',
  'chromsome': 21,
  'start': 5116343,
  'end': 5133805,
  'biotype': 'protein_coding'},
 'FP565260.1': {'gene_id': 'ENSG00000275464',
  'chromsome': 21,
  'start': 5130871,
  'end': 5154658,
  'biotype': 'protein_coding'},
 'FP565260.6': {'gene_id': 'ENSG00000280433',
  'chromsome': 21,
  'start': 5155499,
  'end': 5165472,
  'biotype': 'protein_coding'},
 'AC079801.1': {'gene_id': 'ENSG00000279669',
  'chromsome': 21,
  'start': 5232668,
  'end': 5243833,
  'biotype': 'lncRNA'},
 'LINC01670': {'gene_id': 'ENSG00000279094',
  'chromsome': 21,
  'start': 5499151,
  'end': 5502542,
  'biotype': 'lncRNA'},
 'CU633967.1': {'gene_id': 'ENSG00000274333',
  'chromsome': 21,
  'start': 5553637,
  'end': 5614880,
  'biotype': 'lncRNA'},
 'Y_RNA': {'gene_id': 'ENSG00000276902',
  'chromsome': 21,
  'start': 6365955,
  'end': 6366055,
  'biotype': 'misc_RNA'},
 'FP236315.2': {'gene_id': 'ENSG00000279186',
  'chromsome': 21,
  'start': 5703182,
  'end': 5705637,
  'biotype': 'TEC'},
 'FP236315.3': {'gene_id': 'ENSG00000279784',
  'chromsome': 21,
  'start': 5705345,
  'end': 5707160,
  'biotype': 'lncRNA'},
 'FP236315.1': {'gene_id': 'ENSG00000279064',
  'chromsome': 21,
  'start': 5707004,
  'end': 5709456,
  'biotype': 'lncRNA'},
 'CU639417.1': {'gene_id': 'ENSG00000274559',
  'chromsome': 21,
  'start': 5972924,
  'end': 5973383,
  'biotype': 'protein_coding'},
 'CU639417.3': {'gene_id': 'ENSG00000280013',
  'chromsome': 21,
  'start': 6008604,
  'end': 6008810,
  'biotype': 'processed_pseudogene'},
 'CU639417.2': {'gene_id': 'ENSG00000279769',
  'chromsome': 21,
  'start': 6034690,
  'end': 6036093,
  'biotype': 'TEC'},
 'LINC01669': {'gene_id': 'ENSG00000280191',
  'chromsome': 21,
  'start': 6060340,
  'end': 6076305,
  'biotype': 'lncRNA'},
 'CU639417.4': {'gene_id': 'ENSG00000280095',
  'chromsome': 21,
  'start': 6081193,
  'end': 6082585,
  'biotype': 'lncRNA'},
 'CU639417.5': {'gene_id': 'ENSG00000280179',
  'chromsome': 21,
  'start': 6084364,
  'end': 6091407,
  'biotype': 'lncRNA'},
 'SIK1B': {'gene_id': 'ENSG00000275993',
  'chromsome': 21,
  'start': 6111131,
  'end': 6123778,
  'biotype': 'protein_coding'},
 'CU633906.5': {'gene_id': 'ENSG00000288187',
  'chromsome': 21,
  'start': 6215291,
  'end': 6217681,
  'biotype': 'lncRNA'},
 'CU633906.1': {'gene_id': 'ENSG00000275496',
  'chromsome': 21,
  'start': 6228966,
  'end': 6267317,
  'biotype': 'lncRNA'},
 'CU633906.4': {'gene_id': 'ENSG00000280019',
  'chromsome': 21,
  'start': 6272135,
  'end': 6276532,
  'biotype': 'unprocessed_pseudogene'},
 'CU633906.3': {'gene_id': 'ENSG00000279709',
  'chromsome': 21,
  'start': 6309161,
  'end': 6312948,
  'biotype': 'unprocessed_pseudogene'},
 'CU633906.2': {'gene_id': 'ENSG00000278903',
  'chromsome': 21,
  'start': 6318434,
  'end': 6360415,
  'biotype': 'lncRNA'},
 'CBSL': {'gene_id': 'ENSG00000274276',
  'chromsome': 21,
  'start': 6444869,
  'end': 6468040,
  'biotype': 'protein_coding'},
 'U2AF1L5': {'gene_id': 'ENSG00000275895',
  'chromsome': 21,
  'start': 6484623,
  'end': 6499261,
  'biotype': 'protein_coding'}}
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">genes</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>FP565260.4
FP565260.3
FP565260.5
GATD3B
FP565260.2
FP565260.1
FP565260.6
AC079801.1
LINC01670
CU633967.1
Y_RNA
FP236315.2
FP236315.3
FP236315.1
CU639417.1
CU639417.3
CU639417.2
LINC01669
CU639417.4
CU639417.5
SIK1B
CU633906.5
CU633906.1
CU633906.4
CU633906.3
CU633906.2
CBSL
U2AF1L5
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">genes</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="ow">not</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;FP&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;CU&#39;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>GATD3B
AC079801.1
LINC01670
Y_RNA
LINC01669
SIK1B
CBSL
U2AF1L5
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">genes</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">genes</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="p">[</span><span class="s1">&#39;biotype&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;protein_coding&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">genes</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</span></span></code></pre></div><pre><code>FP565260.5 {'gene_id': 'ENSG00000279687', 'chromsome': 21, 'start': 5073458, 'end': 5087867, 'biotype': 'lncRNA'}
AC079801.1 {'gene_id': 'ENSG00000279669', 'chromsome': 21, 'start': 5232668, 'end': 5243833, 'biotype': 'lncRNA'}
LINC01670 {'gene_id': 'ENSG00000279094', 'chromsome': 21, 'start': 5499151, 'end': 5502542, 'biotype': 'lncRNA'}
CU633967.1 {'gene_id': 'ENSG00000274333', 'chromsome': 21, 'start': 5553637, 'end': 5614880, 'biotype': 'lncRNA'}
Y_RNA {'gene_id': 'ENSG00000276902', 'chromsome': 21, 'start': 6365955, 'end': 6366055, 'biotype': 'misc_RNA'}
FP236315.2 {'gene_id': 'ENSG00000279186', 'chromsome': 21, 'start': 5703182, 'end': 5705637, 'biotype': 'TEC'}
FP236315.3 {'gene_id': 'ENSG00000279784', 'chromsome': 21, 'start': 5705345, 'end': 5707160, 'biotype': 'lncRNA'}
FP236315.1 {'gene_id': 'ENSG00000279064', 'chromsome': 21, 'start': 5707004, 'end': 5709456, 'biotype': 'lncRNA'}
CU639417.3 {'gene_id': 'ENSG00000280013', 'chromsome': 21, 'start': 6008604, 'end': 6008810, 'biotype': 'processed_pseudogene'}
CU639417.2 {'gene_id': 'ENSG00000279769', 'chromsome': 21, 'start': 6034690, 'end': 6036093, 'biotype': 'TEC'}
LINC01669 {'gene_id': 'ENSG00000280191', 'chromsome': 21, 'start': 6060340, 'end': 6076305, 'biotype': 'lncRNA'}
CU639417.4 {'gene_id': 'ENSG00000280095', 'chromsome': 21, 'start': 6081193, 'end': 6082585, 'biotype': 'lncRNA'}
CU639417.5 {'gene_id': 'ENSG00000280179', 'chromsome': 21, 'start': 6084364, 'end': 6091407, 'biotype': 'lncRNA'}
CU633906.5 {'gene_id': 'ENSG00000288187', 'chromsome': 21, 'start': 6215291, 'end': 6217681, 'biotype': 'lncRNA'}
CU633906.1 {'gene_id': 'ENSG00000275496', 'chromsome': 21, 'start': 6228966, 'end': 6267317, 'biotype': 'lncRNA'}
CU633906.4 {'gene_id': 'ENSG00000280019', 'chromsome': 21, 'start': 6272135, 'end': 6276532, 'biotype': 'unprocessed_pseudogene'}
CU633906.3 {'gene_id': 'ENSG00000279709', 'chromsome': 21, 'start': 6309161, 'end': 6312948, 'biotype': 'unprocessed_pseudogene'}
CU633906.2 {'gene_id': 'ENSG00000278903', 'chromsome': 21, 'start': 6318434, 'end': 6360415, 'biotype': 'lncRNA'}
</code></pre>
<h1 id="åˆ›å»ºå‡½æ•°defining-functions">åˆ›å»ºå‡½æ•°(defining functions)</h1>
<p>ä½¿ç”¨<code>def</code>è¯­å¥è¿›è¡Œå‡½æ•°åˆ›å»º.ä¸‹é¢ä¸¾ä¸€äº›ä¾‹å­.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">f_to_c</span><span class="p">(</span><span class="n">fahrenheit</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">celsius</span> <span class="o">=</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">fahrenheit</span><span class="p">)</span> <span class="o">-</span> <span class="mi">32</span><span class="p">)</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">/</span> <span class="mi">9</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">celsius</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">ftemp</span> <span class="o">=</span> <span class="mi">110</span>
</span></span><span class="line"><span class="cl"><span class="n">ctemp</span> <span class="o">=</span> <span class="n">f_to_c</span><span class="p">(</span><span class="mi">56</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ctemp</span>
</span></span></code></pre></div><pre><code>13.33
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;C =&#39;</span><span class="p">,</span> <span class="n">f_to_c</span><span class="p">(</span><span class="n">ftemp</span><span class="p">))</span>
</span></span></code></pre></div><pre><code>C = 43.33
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">roman</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;&#39;&#39;
</span></span></span><span class="line"><span class="cl"><span class="s1">    Returns the integer value of a string in Roman numerals
</span></span></span><span class="line"><span class="cl"><span class="s1">    &#39;&#39;&#39;</span> 
</span></span><span class="line"><span class="cl">    <span class="n">dictionary</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;M&#39;</span><span class="p">:</span><span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">:</span><span class="mi">500</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">:</span><span class="mi">50</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;V&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;I&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">arabic</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># list that holds the Roman numerals as Arabic ciphers</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">letter</span> <span class="ow">in</span> <span class="n">string</span><span class="o">.</span><span class="n">upper</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">letter</span> <span class="ow">in</span> <span class="n">dictionary</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">arabic</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dictionary</span><span class="p">[</span><span class="n">letter</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">arabic</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">arabic</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">arabic</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">            <span class="n">arabic</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> <span class="c1"># (5,10) -&gt; (-5,10)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">arabic</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">arabic</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">seq_list_from_fastq_file</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;&#39;&#39;
</span></span></span><span class="line"><span class="cl"><span class="s1">    Parse fastq file returning two lists, one of all sequences
</span></span></span><span class="line"><span class="cl"><span class="s1">    the other of the quality strings
</span></span></span><span class="line"><span class="cl"><span class="s1">    &#39;&#39;&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">seq_list</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="n">quality_list</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">FASTQ_INPUT</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">line_cnt</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">FASTQ_INPUT</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">line_cnt</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">line_cnt</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">seq_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">line_cnt</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">quality_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                <span class="n">line_cnt</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">seq_list</span><span class="p">,</span> <span class="n">quality_list</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">DNA_codon_table</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="c1">#                        Second Base</span>
</span></span><span class="line"><span class="cl"><span class="c1">#        T             C             A             G</span>
</span></span><span class="line"><span class="cl"><span class="c1"># T</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;TTT&#39;</span><span class="p">:</span> <span class="s1">&#39;Phe&#39;</span><span class="p">,</span> <span class="s1">&#39;TCT&#39;</span><span class="p">:</span> <span class="s1">&#39;Ser&#39;</span><span class="p">,</span> <span class="s1">&#39;TAT&#39;</span><span class="p">:</span> <span class="s1">&#39;Tyr&#39;</span><span class="p">,</span> <span class="s1">&#39;TGT&#39;</span><span class="p">:</span> <span class="s1">&#39;Cys&#39;</span><span class="p">,</span>     <span class="c1"># TxT</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;TTC&#39;</span><span class="p">:</span> <span class="s1">&#39;Phe&#39;</span><span class="p">,</span> <span class="s1">&#39;TCC&#39;</span><span class="p">:</span> <span class="s1">&#39;Ser&#39;</span><span class="p">,</span> <span class="s1">&#39;TAC&#39;</span><span class="p">:</span> <span class="s1">&#39;Tyr&#39;</span><span class="p">,</span> <span class="s1">&#39;TGC&#39;</span><span class="p">:</span> <span class="s1">&#39;Cys&#39;</span><span class="p">,</span>     <span class="c1"># TxC</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;TTA&#39;</span><span class="p">:</span> <span class="s1">&#39;Leu&#39;</span><span class="p">,</span> <span class="s1">&#39;TCA&#39;</span><span class="p">:</span> <span class="s1">&#39;Ser&#39;</span><span class="p">,</span> <span class="s1">&#39;TAA&#39;</span><span class="p">:</span> <span class="s1">&#39;---&#39;</span><span class="p">,</span> <span class="s1">&#39;TGA&#39;</span><span class="p">:</span> <span class="s1">&#39;---&#39;</span><span class="p">,</span>     <span class="c1"># TxA</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;TTG&#39;</span><span class="p">:</span> <span class="s1">&#39;Leu&#39;</span><span class="p">,</span> <span class="s1">&#39;TCG&#39;</span><span class="p">:</span> <span class="s1">&#39;Ser&#39;</span><span class="p">,</span> <span class="s1">&#39;TAG&#39;</span><span class="p">:</span> <span class="s1">&#39;---&#39;</span><span class="p">,</span> <span class="s1">&#39;TGG&#39;</span><span class="p">:</span> <span class="s1">&#39;Trp&#39;</span><span class="p">,</span>     <span class="c1"># TxG</span>
</span></span><span class="line"><span class="cl"><span class="c1"># C</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;CTT&#39;</span><span class="p">:</span> <span class="s1">&#39;Leu&#39;</span><span class="p">,</span> <span class="s1">&#39;CCT&#39;</span><span class="p">:</span> <span class="s1">&#39;Pro&#39;</span><span class="p">,</span> <span class="s1">&#39;CAT&#39;</span><span class="p">:</span> <span class="s1">&#39;His&#39;</span><span class="p">,</span> <span class="s1">&#39;CGT&#39;</span><span class="p">:</span> <span class="s1">&#39;Arg&#39;</span><span class="p">,</span>     <span class="c1"># CxT</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;CTC&#39;</span><span class="p">:</span> <span class="s1">&#39;Leu&#39;</span><span class="p">,</span> <span class="s1">&#39;CCC&#39;</span><span class="p">:</span> <span class="s1">&#39;Pro&#39;</span><span class="p">,</span> <span class="s1">&#39;CAC&#39;</span><span class="p">:</span> <span class="s1">&#39;His&#39;</span><span class="p">,</span> <span class="s1">&#39;CGC&#39;</span><span class="p">:</span> <span class="s1">&#39;Arg&#39;</span><span class="p">,</span>     <span class="c1"># CxC</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;CTA&#39;</span><span class="p">:</span> <span class="s1">&#39;Leu&#39;</span><span class="p">,</span> <span class="s1">&#39;CCA&#39;</span><span class="p">:</span> <span class="s1">&#39;Pro&#39;</span><span class="p">,</span> <span class="s1">&#39;CAA&#39;</span><span class="p">:</span> <span class="s1">&#39;Gln&#39;</span><span class="p">,</span> <span class="s1">&#39;CGA&#39;</span><span class="p">:</span> <span class="s1">&#39;Arg&#39;</span><span class="p">,</span>     <span class="c1"># CxA</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;CTG&#39;</span><span class="p">:</span> <span class="s1">&#39;Leu&#39;</span><span class="p">,</span> <span class="s1">&#39;CCG&#39;</span><span class="p">:</span> <span class="s1">&#39;Pro&#39;</span><span class="p">,</span> <span class="s1">&#39;CAG&#39;</span><span class="p">:</span> <span class="s1">&#39;Gln&#39;</span><span class="p">,</span> <span class="s1">&#39;CGG&#39;</span><span class="p">:</span> <span class="s1">&#39;Arg&#39;</span><span class="p">,</span>     <span class="c1"># CxG</span>
</span></span><span class="line"><span class="cl"><span class="c1"># A</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;ATT&#39;</span><span class="p">:</span> <span class="s1">&#39;Ile&#39;</span><span class="p">,</span> <span class="s1">&#39;ACT&#39;</span><span class="p">:</span> <span class="s1">&#39;Thr&#39;</span><span class="p">,</span> <span class="s1">&#39;AAT&#39;</span><span class="p">:</span> <span class="s1">&#39;Asn&#39;</span><span class="p">,</span> <span class="s1">&#39;AGT&#39;</span><span class="p">:</span> <span class="s1">&#39;Ser&#39;</span><span class="p">,</span>     <span class="c1"># AxT</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;ATC&#39;</span><span class="p">:</span> <span class="s1">&#39;Ile&#39;</span><span class="p">,</span> <span class="s1">&#39;ACC&#39;</span><span class="p">:</span> <span class="s1">&#39;Thr&#39;</span><span class="p">,</span> <span class="s1">&#39;AAC&#39;</span><span class="p">:</span> <span class="s1">&#39;Asn&#39;</span><span class="p">,</span> <span class="s1">&#39;AGC&#39;</span><span class="p">:</span> <span class="s1">&#39;Ser&#39;</span><span class="p">,</span>     <span class="c1"># AxC</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;ATA&#39;</span><span class="p">:</span> <span class="s1">&#39;Ile&#39;</span><span class="p">,</span> <span class="s1">&#39;ACA&#39;</span><span class="p">:</span> <span class="s1">&#39;Thr&#39;</span><span class="p">,</span> <span class="s1">&#39;AAA&#39;</span><span class="p">:</span> <span class="s1">&#39;Lys&#39;</span><span class="p">,</span> <span class="s1">&#39;AGA&#39;</span><span class="p">:</span> <span class="s1">&#39;Arg&#39;</span><span class="p">,</span>     <span class="c1"># AxA</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;ATG&#39;</span><span class="p">:</span> <span class="s1">&#39;Met&#39;</span><span class="p">,</span> <span class="s1">&#39;ACG&#39;</span><span class="p">:</span> <span class="s1">&#39;Thr&#39;</span><span class="p">,</span> <span class="s1">&#39;AAG&#39;</span><span class="p">:</span> <span class="s1">&#39;Lys&#39;</span><span class="p">,</span> <span class="s1">&#39;AGG&#39;</span><span class="p">:</span> <span class="s1">&#39;Arg&#39;</span><span class="p">,</span>     <span class="c1"># AxG</span>
</span></span><span class="line"><span class="cl"><span class="c1"># G</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;GTT&#39;</span><span class="p">:</span> <span class="s1">&#39;Val&#39;</span><span class="p">,</span> <span class="s1">&#39;GCT&#39;</span><span class="p">:</span> <span class="s1">&#39;Ala&#39;</span><span class="p">,</span> <span class="s1">&#39;GAT&#39;</span><span class="p">:</span> <span class="s1">&#39;Asp&#39;</span><span class="p">,</span> <span class="s1">&#39;GGT&#39;</span><span class="p">:</span> <span class="s1">&#39;Gly&#39;</span><span class="p">,</span>     <span class="c1"># GxT</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;GTC&#39;</span><span class="p">:</span> <span class="s1">&#39;Val&#39;</span><span class="p">,</span> <span class="s1">&#39;GCC&#39;</span><span class="p">:</span> <span class="s1">&#39;Ala&#39;</span><span class="p">,</span> <span class="s1">&#39;GAC&#39;</span><span class="p">:</span> <span class="s1">&#39;Asp&#39;</span><span class="p">,</span> <span class="s1">&#39;GGC&#39;</span><span class="p">:</span> <span class="s1">&#39;Gly&#39;</span><span class="p">,</span>     <span class="c1"># GxC</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;GTA&#39;</span><span class="p">:</span> <span class="s1">&#39;Val&#39;</span><span class="p">,</span> <span class="s1">&#39;GCA&#39;</span><span class="p">:</span> <span class="s1">&#39;Ala&#39;</span><span class="p">,</span> <span class="s1">&#39;GAA&#39;</span><span class="p">:</span> <span class="s1">&#39;Glu&#39;</span><span class="p">,</span> <span class="s1">&#39;GGA&#39;</span><span class="p">:</span> <span class="s1">&#39;Gly&#39;</span><span class="p">,</span>     <span class="c1"># GxA</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;GTG&#39;</span><span class="p">:</span> <span class="s1">&#39;Val&#39;</span><span class="p">,</span> <span class="s1">&#39;GCG&#39;</span><span class="p">:</span> <span class="s1">&#39;Ala&#39;</span><span class="p">,</span> <span class="s1">&#39;GAG&#39;</span><span class="p">:</span> <span class="s1">&#39;Glu&#39;</span><span class="p">,</span> <span class="s1">&#39;GGG&#39;</span><span class="p">:</span> <span class="s1">&#39;Gly&#39;</span>      <span class="c1"># GxG</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">dna_seq</span> <span class="o">=</span> <span class="s1">&#39;ATGATATGGAGGAGGTAGCCGCGCGCCATGCGCGCTATATTTTGGTAT&#39;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">translate_DNA_codon</span><span class="p">(</span><span class="n">codon</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">DNA_codon_table</span><span class="p">[</span><span class="n">codon</span><span class="p">]</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">translate</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;&#39;&#39;Return the animo acid sequence corresponding to the DNA
</span></span></span><span class="line"><span class="cl"><span class="s1">    sequence seq&#39;&#39;&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">translation</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span> <span class="o">%</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">3</span><span class="p">):</span> <span class="c1"># every third base</span>
</span></span><span class="line"><span class="cl">        <span class="n">translation</span> <span class="o">+=</span> <span class="n">translate_DNA_codon</span><span class="p">(</span><span class="n">seq</span><span class="p">[</span><span class="n">n</span><span class="p">:</span><span class="n">n</span><span class="o">+</span><span class="mi">3</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">translation</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">translate</span><span class="p">(</span><span class="n">dna_seq</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>'MetIleTrpArgArg---ProArgAlaMetArgAlaIlePheTrpTyr'
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">translate_in_frame</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="n">framenum</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;&#39;&#39;Return the translation of seq in framenum 1, 2, or 3&#39;&#39;&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">translate</span><span class="p">(</span><span class="n">seq</span><span class="p">[</span><span class="n">framenum</span><span class="o">-</span><span class="mi">1</span><span class="p">:])</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">translate_in_frame</span><span class="p">(</span><span class="n">dna_seq</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>'---TyrGlyGlyGlySerArgAlaProCysAlaLeuTyrPheGly'
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">print_translation_in_frame</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="n">framenum</span><span class="p">,</span> <span class="n">prefix</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;&#39;&#39;Print the translation of seq in framenum preceded by prefix&#39;&#39;&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">prefix</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="n">framenum</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="n">framenum</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="n">translate_in_frame</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="n">framenum</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">          <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">print_translation_in_frame</span><span class="p">(</span><span class="n">dna_seq</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;Frame &#39;</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>Frame 2  ---TyrGlyGlyGlySerArgAlaProCysAlaLeuTyrPheGly
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">print_translations</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;&#39;&#39;Print the translations of seq in all three reading frames,
</span></span></span><span class="line"><span class="cl"><span class="s1">    each preceded by prefix&#39;&#39;&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># print DNA sequence, indented to line up after prefix is added</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># to translation lines</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="p">),</span> <span class="n">seq</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">framenum</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">print_translation_in_frame</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="n">framenum</span><span class="p">,</span> <span class="n">prefix</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">print_translations</span><span class="p">(</span><span class="n">dna_seq</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>  ATGATATGGAGGAGGTAGCCGCGCGCCATGCGCGCTATATTTTGGTAT
1 MetIleTrpArgArg---ProArgAlaMetArgAlaIlePheTrpTyr
2  ---TyrGlyGlyGlySerArgAlaProCysAlaLeuTyrPheGly
3   AspMetGluGluValAlaAlaArgHisAlaArgTyrIleLeuVal
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">translate_with_open_reading_frames</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="n">framenum</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;&#39;&#39;Return the translation of seq in framenum (1, 2, or 3), with
</span></span></span><span class="line"><span class="cl"><span class="s1">    ---&#39;s when not within an open reading frame; assume the read is
</span></span></span><span class="line"><span class="cl"><span class="s1">    not in an open frame when at the beginning of seq&#39;&#39;&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">open</span> <span class="o">=</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">    <span class="n">translation</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">seqlength</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">framenum</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">framenum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">seqlength</span> <span class="o">-</span> <span class="p">(</span><span class="n">seqlength</span> <span class="o">%</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">3</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">codon</span> <span class="o">=</span> <span class="n">translate_DNA_codon</span><span class="p">(</span><span class="n">seq</span><span class="p">[</span><span class="n">n</span><span class="p">:</span><span class="n">n</span><span class="o">+</span><span class="mi">3</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="nb">open</span> <span class="o">=</span> <span class="p">(</span><span class="nb">open</span> <span class="ow">or</span> <span class="n">codon</span> <span class="o">==</span> <span class="s2">&#34;Met&#34;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">codon</span> <span class="o">==</span> <span class="s2">&#34;---&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">translation</span> <span class="o">+=</span> <span class="n">codon</span> <span class="k">if</span> <span class="nb">open</span> <span class="k">else</span> <span class="s2">&#34;---&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">translation</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">translate_with_open_reading_frames</span><span class="p">(</span><span class="n">dna_seq</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>'MetIleTrpArgArg------------MetArgAlaIlePheTrpTyr'
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">print_translation_with_open_reading_frame</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="n">framenum</span><span class="p">,</span> <span class="n">prefix</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">prefix</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="n">framenum</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="n">framenum</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="n">translate_with_open_reading_frames</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="n">framenum</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">          <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">print_translation_with_open_reading_frame</span><span class="p">(</span><span class="n">dna_seq</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Seq &#39;</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>Seq 1 MetIleTrpArgArg------------MetArgAlaIlePheTrpTyr
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">print_translations_with_open_reading_frames</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="p">),</span> <span class="n">seq</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">print_translation_with_open_reading_frame</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="n">frame</span><span class="p">,</span> <span class="n">prefix</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">print_translations_with_open_reading_frames</span><span class="p">(</span><span class="n">dna_seq</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>  ATGATATGGAGGAGGTAGCCGCGCGCCATGCGCGCTATATTTTGGTAT
1 MetIleTrpArgArg------------MetArgAlaIlePheTrpTyr
2  ---------------------------------------------
3   ---MetGluGluValAlaAlaArgHisAlaArgTyrIleLeuVal
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">print_translations_in_frames_in_both_directions</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">print_translations</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="s1">&#39;5</span><span class="se">\&#39;</span><span class="s1">-&gt;3</span><span class="se">\&#39;</span><span class="s1"> ORF &#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">print_translations</span><span class="p">(</span><span class="n">seq</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;3</span><span class="se">\&#39;</span><span class="s1">-&gt;5</span><span class="se">\&#39;</span><span class="s1"> ORF &#39;</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">print_translations_in_frames_in_both_directions</span><span class="p">(</span><span class="n">dna_seq</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>             ATGATATGGAGGAGGTAGCCGCGCGCCATGCGCGCTATATTTTGGTAT
5'-&gt;3' ORF 1 MetIleTrpArgArg---ProArgAlaMetArgAlaIlePheTrpTyr
5'-&gt;3' ORF 2  ---TyrGlyGlyGlySerArgAlaProCysAlaLeuTyrPheGly
5'-&gt;3' ORF 3   AspMetGluGluValAlaAlaArgHisAlaArgTyrIleLeuVal

             TATGGTTTTATATCGCGCGTACCGCGCGCCGATGGAGGAGGTATAGTA
3'-&gt;5' ORF 1 TyrGlyPheIleSerArgValProArgAlaAspGlyGlyGlyIleVal
3'-&gt;5' ORF 2  MetValLeuTyrArgAlaTyrArgAlaProMetGluGluVal---
3'-&gt;5' ORF 3   TrpPheTyrIleAlaArgThrAlaArgArgTrpArgArgTyrSer
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">print_translations_with_open_reading_frames_in_both_directions</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">print_translations_with_open_reading_frames</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="s1">&#39;5</span><span class="se">\&#39;</span><span class="s1">-&gt;3</span><span class="se">\&#39;</span><span class="s1"> ORF &#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">print_translations_with_open_reading_frames</span><span class="p">(</span><span class="n">seq</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;3</span><span class="se">\&#39;</span><span class="s1">-&gt;5</span><span class="se">\&#39;</span><span class="s1"> ORF &#39;</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">print_translations_with_open_reading_frames_in_both_directions</span><span class="p">(</span><span class="n">dna_seq</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>             ATGATATGGAGGAGGTAGCCGCGCGCCATGCGCGCTATATTTTGGTAT
5'-&gt;3' ORF 1 MetIleTrpArgArg------------MetArgAlaIlePheTrpTyr
5'-&gt;3' ORF 2  ---------------------------------------------
5'-&gt;3' ORF 3   ---MetGluGluValAlaAlaArgHisAlaArgTyrIleLeuVal

             TATGGTTTTATATCGCGCGTACCGCGCGCCGATGGAGGAGGTATAGTA
3'-&gt;5' ORF 1 ------------------------------------------------
3'-&gt;5' ORF 2  MetValLeuTyrArgAlaTyrArgAlaProMetGluGluVal---
3'-&gt;5' ORF 3   ---------------------------------------------
</code></pre>
<h1 id="mapå‡½æ•°">mapå‡½æ•°</h1>
<p><code>map</code>å‡½æ•°è·ŸRä¸­çš„<code>apply</code>å®¶æ—æœ‰ç‚¹åƒ.</p>
<p><code>map</code>å‡½æ•°æ¥å—ä¸¤ä¸ªå‚æ•°,ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå‡½æ•°,ç¬¬äºŒä¸ªå‚æ•°ä¸ºä¸€ä¸ªåˆ—è¡¨,ç„¶åå‡½æ•°å¯¹åˆ—è¡¨ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ è¿›è¡Œå¤„ç†.ç„¶åè¿”å›é•¿åº¦
å’Œè¾“å…¥åˆ—è¡¨ç›¸åŒçš„åˆ—è¡¨.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># starting list</span>
</span></span><span class="line"><span class="cl"><span class="n">mylist</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">3.2</span><span class="p">,</span> <span class="mf">5.4</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">]</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># round all values in list to nearest int</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">round</span><span class="p">,</span> <span class="n">mylist</span><span class="p">)))</span>
</span></span></code></pre></div><pre><code>[1, 3, 5, 2, 1]
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># define function to square values</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">sqr</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># square each value of list</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">sqr</span><span class="p">,</span> <span class="n">mylist</span><span class="p">)))</span>
</span></span></code></pre></div><pre><code>[1.44, 10.24, 29.16, 4.41, 0.64]
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># mylist #2</span>
</span></span><span class="line"><span class="cl"><span class="n">mylist2</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;71&#39;</span><span class="p">,</span> <span class="s1">&#39;72&#39;</span><span class="p">,</span> <span class="s1">&#39;73&#39;</span><span class="p">,</span> <span class="s1">&#39;74&#39;</span><span class="p">]</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># convert each value in list to binary (base 2)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">chr</span><span class="p">,</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">mylist2</span><span class="p">))))</span>
</span></span></code></pre></div><pre><code>['G', 'H', 'I', 'J']
</code></pre>
<h1 id="list-comprehensionåˆ—è¡¨æ¨å¯¼è¡¨è¾¾å¼">list comprehension(åˆ—è¡¨æ¨å¯¼è¡¨è¾¾å¼)</h1>
<p>åˆ—è¡¨æ¨å¯¼è¡¨è¾¾å¼å¯ä»¥ä»ä¸€ä¸ªåˆ—è¡¨å¿«é€Ÿçš„å¾—åˆ°å¦å¤–ä¸€ä¸ªåˆ—è¡¨,åœ¨å¾ˆå¤šæƒ…å†µä¸‹,å¯ä»¥æ›¿æ¢æ‰æ¯”è¾ƒç®€å•çš„<code>for</code>å¾ªç¯.</p>
<p><b>[</b> expression <b>for</b> item <b>in</b> list <b>if</b> conditional <b>]</b></p>
<p><code>for item in list:
if conditional:
expression</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">mylist</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="s1">&#39;spam&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">mylist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">mylist</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>[115, 112, 97, 109]
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># convert a string into a list of ASCII values</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="nb">ord</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="s1">&#39;spam&#39;</span><span class="p">]</span>
</span></span></code></pre></div><pre><code>[115, 112, 97, 109]
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># convert a string into a set of ASCII values</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="nb">ord</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="s1">&#39;spaam&#39;</span><span class="p">}</span>  <span class="c1"># square to curly</span>
</span></span></code></pre></div><pre><code>{97, 109, 112, 115}
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># convert a string into a dict of ASCII values</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="n">x</span><span class="p">:</span> <span class="nb">ord</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="s1">&#39;spaam&#39;</span><span class="p">}</span>
</span></span></code></pre></div><pre><code>{'s': 115, 'p': 112, 'a': 97, 'm': 109}
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">S</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="n">V</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="n">M</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;S =&#39;</span><span class="p">,</span> <span class="n">S</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">13</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">V</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;V =&#39;</span><span class="p">,</span> <span class="n">V</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">S</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">M</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;M =&#39;</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>S = [0, 1, 4, 9, 16, 25, 36, 49, 64, 81]
V = [1, 2, 4, 8, 16, 32, 64, 128, 256, 512, 1024, 2048, 4096]
M = [0, 4, 16, 36, 64]
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">S</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl"><span class="n">V</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="o">**</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">13</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl"><span class="n">M</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">S</span> <span class="k">if</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;S =&#39;</span><span class="p">,</span> <span class="n">S</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;V =&#39;</span><span class="p">,</span> <span class="n">V</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;M =&#39;</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>S = [0, 1, 4, 9, 16, 25, 36, 49, 64, 81]
V = [1, 2, 4, 8, 16, 32, 64, 128, 256, 512, 1024, 2048, 4096]
M = [0, 4, 16, 36, 64]
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># start with a matrix, in this case represented as three lists</span>
</span></span><span class="line"><span class="cl"><span class="n">M</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">     <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">     <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl"><span class="n">col2</span> <span class="o">=</span> <span class="p">[]</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># print out just the 2nd column</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">M</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">col2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">col2</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>[2, 5, 8]
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">M</span><span class="p">]</span>
</span></span></code></pre></div><pre><code>[2, 5, 8]
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># Nested comprehensions</span>
</span></span><span class="line"><span class="cl"><span class="c1"># tuples that are the cross products of two lists: [-1,0,1] and [-1,0,1]</span>
</span></span><span class="line"><span class="cl"><span class="n">mylist</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="n">y</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">mylist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">mylist</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>[(-1, -1), (0, 0), (1, 1)]
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="n">y</span><span class="p">]</span>
</span></span></code></pre></div><pre><code>[(-1, -1), (0, 0), (1, 1)]
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">numbers</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">14</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">doubled_odds</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">numbers</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">doubled_odds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">doubled_odds</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>[2, 6, 10, 14, 22, 22]
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">doubled_odds</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span> <span class="o">*</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">numbers</span> <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span> <span class="p">(</span><span class="n">doubled_odds</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>[2, 6, 10, 14, 22, 22]
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># output increasing amount of string</span>
</span></span><span class="line"><span class="cl"><span class="n">string</span> <span class="o">=</span> <span class="s1">&#39;elephants&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">string</span><span class="p">[:</span><span class="n">c</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">string</span><span class="p">))]</span>
</span></span></code></pre></div><pre><code>['e',
 'el',
 'ele',
 'elep',
 'eleph',
 'elepha',
 'elephan',
 'elephant',
 'elephants']
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># generate all k-mers of 23bp for a string of nucleotides</span>
</span></span><span class="line"><span class="cl"><span class="c1">#                1         2         3         4</span>
</span></span><span class="line"><span class="cl"><span class="c1">#      01234567890123456789012345678901234567890</span>
</span></span><span class="line"><span class="cl"><span class="n">dna</span> <span class="o">=</span> <span class="s1">&#39;ACTGATCGATTACGTATAGTAGAATTCTATCATATATATGG&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">kmers</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">dna</span><span class="p">)</span> <span class="o">-</span> <span class="mi">22</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">kmers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dna</span><span class="p">[</span><span class="n">c</span><span class="p">:</span><span class="n">c</span><span class="o">+</span><span class="mi">23</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">kmers</span>
</span></span></code></pre></div><pre><code>['ACTGATCGATTACGTATAGTAGA',
 'CTGATCGATTACGTATAGTAGAA',
 'TGATCGATTACGTATAGTAGAAT',
 'GATCGATTACGTATAGTAGAATT',
 'ATCGATTACGTATAGTAGAATTC',
 'TCGATTACGTATAGTAGAATTCT',
 'CGATTACGTATAGTAGAATTCTA',
 'GATTACGTATAGTAGAATTCTAT',
 'ATTACGTATAGTAGAATTCTATC',
 'TTACGTATAGTAGAATTCTATCA',
 'TACGTATAGTAGAATTCTATCAT',
 'ACGTATAGTAGAATTCTATCATA',
 'CGTATAGTAGAATTCTATCATAT',
 'GTATAGTAGAATTCTATCATATA',
 'TATAGTAGAATTCTATCATATAT',
 'ATAGTAGAATTCTATCATATATA',
 'TAGTAGAATTCTATCATATATAT',
 'AGTAGAATTCTATCATATATATG',
 'GTAGAATTCTATCATATATATGG']
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># generate all 23-mers of dna</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">dna</span><span class="p">[</span><span class="n">c</span><span class="p">:</span><span class="n">c</span><span class="o">+</span><span class="mi">23</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">dna</span><span class="p">)</span> <span class="o">-</span> <span class="mi">22</span><span class="p">)]</span>
</span></span></code></pre></div><pre><code>['ACTGATCGATTACGTATAGTAGA',
 'CTGATCGATTACGTATAGTAGAA',
 'TGATCGATTACGTATAGTAGAAT',
 'GATCGATTACGTATAGTAGAATT',
 'ATCGATTACGTATAGTAGAATTC',
 'TCGATTACGTATAGTAGAATTCT',
 'CGATTACGTATAGTAGAATTCTA',
 'GATTACGTATAGTAGAATTCTAT',
 'ATTACGTATAGTAGAATTCTATC',
 'TTACGTATAGTAGAATTCTATCA',
 'TACGTATAGTAGAATTCTATCAT',
 'ACGTATAGTAGAATTCTATCATA',
 'CGTATAGTAGAATTCTATCATAT',
 'GTATAGTAGAATTCTATCATATA',
 'TATAGTAGAATTCTATCATATAT',
 'ATAGTAGAATTCTATCATATATA',
 'TAGTAGAATTCTATCATATATAT',
 'AGTAGAATTCTATCATATATATG',
 'GTAGAATTCTATCATATATATGG']
</code></pre>
<h1 id="zipå‡½æ•°">zipå‡½æ•°</h1>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># reverse key and value in mydict</span>
</span></span><span class="line"><span class="cl"><span class="n">mydict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span><span class="mi">12</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span><span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">:</span><span class="mi">23</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">:</span><span class="mi">14</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nb">reversed</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">mydict</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">mydict</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="nb">reversed</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>{12: 'A', 25: 'B', 23: 'C', 14: 'D'}
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># same as above</span>
</span></span><span class="line"><span class="cl"><span class="nb">reversed</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">mydict</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">mydict</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="nb">reversed</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>{12: 'A', 25: 'B', 23: 'C', 14: 'D'}
</code></pre>
<h1 id="ç»ƒä¹ é¢˜">ç»ƒä¹ é¢˜</h1>
<h2 id="åŠ è½½library">åŠ è½½library</h2>
<p>ä¸åŒçš„åŠ è½½libyraryæ–¹å¼</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># import the math library</span>
</span></span><span class="line"><span class="cl"><span class="c1"># find the sqrt of 9</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">math</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># import the math library, but call it m</span>
</span></span><span class="line"><span class="cl"><span class="c1"># find the sqrt of 9</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">math</span> <span class="k">as</span> <span class="nn">m</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># import ONLY the sqrt function from math</span>
</span></span><span class="line"><span class="cl"><span class="c1"># find the sqrt of 9</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">sqrt</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># import ONLY the sqrt function from math, but call it s</span>
</span></span><span class="line"><span class="cl"><span class="c1"># find the sqrt of 9</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">sqrt</span> <span class="k">as</span> <span class="n">s</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
</span></span></code></pre></div><pre><code>3.0
3.0
3.0
3.0
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">math</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
</span></span></code></pre></div><pre><code>1.9459101490553132
2.807354922057604
3.0
24
</code></pre>
<p>There are so many more methods in the math library!
Put your cursor after the &lsquo;math.&rsquo; and press &rsquo;tab&rsquo; to see them all!
<code>math</code>åŒ…ä¸­æœ‰éå¸¸å¤šçš„å‡½æ•°,åªéœ€è¦åŠ è½½åŒ…ä¹‹å,ç„¶åè¾“å…¥<code>math.</code>ç„¶åç‚¹å‡»tabé”®å°±ä¼šè‡ªåŠ¨å‡ºç°ä»£ç è¡¥é½.</p>
<h3 id="gzipåŒ…">gzipåŒ…</h3>
<p><code>gzip</code>åŒ…ä¸»è¦æ˜¯ç”¨æ¥è¯»å–å‹ç¼©ä¸ºzipæ ¼å¼çš„æ–‡ä»¶.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span> <span class="k">as</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl"><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">()</span>
</span></span></code></pre></div><pre><code>['.ipynb_checkpoints',
 'featured.png',
 'index.ipynb',
 'index.md',
 'Practice06-Veronica.ipynb',
 'sample.txt',
 'sample.txt.gz',
 'Untitled.ipynb']
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">gzip</span>
</span></span><span class="line"><span class="cl"><span class="c1"># The most common use is to read gzipped files</span>
</span></span><span class="line"><span class="cl"><span class="n">gzippedFileName</span> <span class="o">=</span> <span class="s1">&#39;sample.txt.gz&#39;</span>
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="n">gzip</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">gzippedFileName</span><span class="p">,</span> <span class="s1">&#39;rt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">inFile</span><span class="p">:</span> <span class="c1"># don&#39;t forget to use &#39;rt&#39; not just &#39;r&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">inFile</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>1	2	3	4	5
6	7	8	9	10
11	12	13	14	15
16	17	18	19	20
21	22	23	24	25
26	27	28	29	30
</code></pre>
<h3 id="osåŒ…"><code>os</code>åŒ…</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Returns your current directory</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Returns a list containing the names of the files in the specified directory</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Create a new directory</span>
</span></span><span class="line"><span class="cl"><span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s1">&#39;newDirectory&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Remove a a directory</span>
</span></span><span class="line"><span class="cl"><span class="n">os</span><span class="o">.</span><span class="n">removedirs</span><span class="p">(</span><span class="s1">&#39;newDirectory&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;newFile.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="c1"># this creates a new empty file</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Remove a file</span>
</span></span><span class="line"><span class="cl"><span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;newFile.txt&#39;</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>D:\my github\shen\content\en\post\2019-12-02-python-for-genomics-class_day06
['.ipynb_checkpoints', 'featured.png', 'index.ipynb', 'index.md', 'Practice06-Veronica.ipynb', 'sample.txt', 'sample.txt.gz', 'Untitled.ipynb']
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># THIS CELL WON&#39;T ACTUALLY EXECUTE</span>
</span></span><span class="line"><span class="cl"><span class="c1"># THEY&#39;RE JUST EXAMPLES</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Change the current working directory to the specified path.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#ä¿®æ”¹è·¯å¾„çš„æ—¶å€™,å¦‚æœæ²¡æœ‰è¿™ä¸ªè·¯å¾„,ä¼šæŠ¥é”™.</span>
</span></span><span class="line"><span class="cl"><span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s1">&#39;PATH&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">except</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;No this PATH&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Test whether a path exists.</span>
</span></span><span class="line"><span class="cl"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s1">&#39;PATH&#39;</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>No this PATH





False
</code></pre>
<h3 id="randomåŒ…"><code>random</code>åŒ…</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">random</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Returns random number from the interval [0, 1)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Returns a random number between the minimum (inclusive) and maximum (not inclusive) provided</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">101</span><span class="p">))</span>
</span></span></code></pre></div><pre><code>0.7176637829068632
97
</code></pre>
<h3 id="ä¸åŒçš„æ–¹æ³•å–naviageä¸€ä¸ªæ–‡ä»¶file">ä¸åŒçš„æ–¹æ³•å–naviageä¸€ä¸ªæ–‡ä»¶(file)</h3>
<p>ä½¿ç”¨<code>open()</code>å‡½æ•°æ‰“å¼€,ç„¶åç›´æ¥ä½¿ç”¨<code>read()</code>æ–¹æ³•ç›´æ¥å¾—åˆ°æ‰€æœ‰çš„å†…å®¹.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">inFileName</span> <span class="o">=</span> <span class="s1">&#39;sample.txt&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">inFileName</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">inFile</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">inFile_string</span> <span class="o">=</span> <span class="n">inFile</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">inFile</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">inFile_string</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>&lt;class '_io.TextIOWrapper'&gt;
1	2	3	4	5
6	7	8	9	10
11	12	13	14	15
16	17	18	19	20
21	22	23	24	25
26	27	28	29	30
</code></pre>
<p>ç¬¬äºŒç§æ–¹æ³•å¯ä»¥å¯¹æ¯è¡Œè¿›è¡Œå¤„ç†.
å…¶å®ä¸€ç›´æœ‰ä¸ªç–‘é—®,èƒ½ä¸èƒ½ä¸åœ¨å¾ªç¯ä¸­æ‹¿åˆ°è¿™ä¸ªæ–‡ä»¶çš„æŸä¸€è¡Œçš„å†…å®¹?</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">inFileName</span> <span class="o">=</span> <span class="s1">&#39;sample.txt&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">inFileName</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">inFile</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">inFile</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>   <span class="c1"># .rstrip() and .lstrip() remove from just the right or left sides of the line</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>1	2	3	4	5
6	7	8	9	10
11	12	13	14	15
16	17	18	19	20
21	22	23	24	25
26	27	28	29	30
</code></pre>
<p>å¦å¤–ä¸€ç§æ–¹æ³•,åªè¯»å–æŸä¸€è¡Œ,ä½¿ç”¨ä¸‹é¢ä¸¤ä¸ªå‡½æ•°:
<code>next(inFile)</code>æˆ–è€…<code>inFile.readline()</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># This is often useful for skipping the header of files!</span>
</span></span><span class="line"><span class="cl"><span class="c1">#ä¸»è¦ç”¨æ¥éƒ¨è¯»å–ç¬¬ä¸€è¡Œ</span>
</span></span><span class="line"><span class="cl"><span class="n">inFileName</span> <span class="o">=</span> <span class="s1">&#39;sample.txt&#39;</span>
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">inFileName</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">inFile</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">firstLine</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">inFile</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">firstLine</span><span class="p">)</span> <span class="c1"># first line will print</span>
</span></span><span class="line"><span class="cl">    <span class="n">secondLine</span> <span class="o">=</span> <span class="n">inFile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">secondLine</span><span class="p">)</span> <span class="c1"># second line will print</span>
</span></span><span class="line"><span class="cl">    <span class="n">thirdLine2</span> <span class="o">=</span> <span class="n">inFile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">thirdLine2</span><span class="p">)</span> <span class="c1"># third line will print</span>
</span></span></code></pre></div><pre><code>1	2	3	4	5

6	7	8	9	10

11	12	13	14	15
</code></pre>
<h3 id="ä»urlè¯»å–æ•°æ®æ–‡ä»¶">ä»urlè¯»å–æ•°æ®æ–‡ä»¶</h3>
<h4 id="ä»ä¸€ä¸ªurlè¯»å–zipå‹ç¼©æ ¼æ–¯çš„æ–‡ä»¶">ä»ä¸€ä¸ªurlè¯»å–zipå‹ç¼©æ ¼æ–¯çš„æ–‡ä»¶</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">##åŠ è½½éœ€è¦ç”¨åˆ°çš„åŒ…</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">urllib.request</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">gzip</span>
</span></span><span class="line"><span class="cl"><span class="n">URL</span> <span class="o">=</span> <span class="s1">&#39;https://www.encodeproject.org/files/ENCFF215GBK/@@download/ENCFF215GBK.fastq.gz&#39;</span>
</span></span><span class="line"><span class="cl"><span class="c1">#URL = &#39;https://www.encodeproject.org/files/gencode.v24.primary_assembly.annotation/@@download/gencode.v24.primary_assembly.annotation.gtf.gz&#39;</span>
</span></span><span class="line"><span class="cl"><span class="c1">##ä½¿ç”¨`urlopen()`å‡½æ•°æ‰“é“¾æ¥</span>
</span></span><span class="line"><span class="cl"><span class="n">response</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">URL</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="n">gzip</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="s1">&#39;rt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">inFile</span><span class="p">:</span>  <span class="c1"># don&#39;t forget to use &#39;rt&#39; not just &#39;r&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">inFile</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="c1">#** Parsing of file goes here **</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">8</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>
</span></span></code></pre></div><pre><code>@HWI-ST1309F:188:C684MANXX:6:1101:1070:2027 1:Y:0:GCGAAAC
ATNTTTTTTTATTATTATTATTTTAANACNCCTGGCATCTGTTGCTATTT
+
BB#&lt;&lt;//BFFFBF/&lt;FFF&lt;F/&lt;&lt;FBB#&lt;&lt;#&lt;&lt;&lt;&lt;/&lt;////&lt;FBFBFFF##
@HWI-ST1309F:188:C684MANXX:6:1101:1169:2086 1:N:0:GCGAAAC
AGCTAAGGGTTTACCCTGTTTGCTTTCATATTCCAGTAGCCATTTAAAAT
+
BBBBBFBFFBBF&lt;FFFFFBB&lt;FBFFF&lt;/FF&lt;FFBFFFFFFFF&lt;/FBFFF&lt;
</code></pre>
<h4 id="ä»ä¸€ä¸ªurlè¯»å–ézipå‹ç¼©æ ¼æ–¯çš„æ–‡ä»¶">ä»ä¸€ä¸ªurlè¯»å–ézipå‹ç¼©æ ¼æ–¯çš„æ–‡ä»¶</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">URL</span> <span class="o">=</span> <span class="s1">&#39;https://hgdownload.soe.ucsc.edu/gbdb/hg38/snp/snp142.fa&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">response</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">URL</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#line = line.strip()</span>
</span></span><span class="line"><span class="cl">    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#decodeæ–¹æ³•</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#** Parsing of file goes here **</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">8</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">break</span>
</span></span></code></pre></div><pre><code>&gt;rs171
tcattgatgg acatttgggt tggttccagg tctttgctat tgcgagtagt gccacaataa atatacgtgt gcatgtgtct
tgatagtagc atgatttata atcctttggg tatataccca ctaatgggat ggctgggtca aatggtattt ctagttctag
atccttgagg aatcaccaca ctgtcttcca catggttgaa ctaatttaca gtcccaacaa cagtgtaaaa gtgttcctat
ttctccatat cctctccagc acctgttgtt tcctgacttt ttaatgatca ccattctaac tgttgcgaga tggtatctca
ttgtggtttt gatttgcatt tctctgatgg gcagtgatga tgagcatttt ttcatgtgtc tgttggctgc ataaatgtct
tcttttggga agtgtctgtt catatccatt gcctagtttt gatggggttg tttgatttat ttcttgtaaa tttgtttacg
ttcgttgtag attctggat
</code></pre>
<h2 id="åˆ—è¡¨æ¨å¯¼å¼å’Œmapå‡½æ•°">åˆ—è¡¨æ¨å¯¼å¼å’Œmap()å‡½æ•°</h2>
<p>EXAMPLE: Three ways to convert a list of strings to a list of integers</p>
<h3 id="1-ä½¿ç”¨å¾ªç¯">1. ä½¿ç”¨å¾ªç¯</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">myList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="s1">&#39;4&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">myList_int</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">myList</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">num</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">myList_int</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">myList_int</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>[1, 2, 3, 4]
</code></pre>
<h3 id="2-ä½¿ç”¨åˆ—è¡¨æ¨å¯¼å¼">2. ä½¿ç”¨åˆ—è¡¨æ¨å¯¼å¼</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">myList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="s1">&#39;4&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">myList</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">myList</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">myList</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>[1, 2, 3, 4]
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># Here&#39;s how you would convert to an integer AND multiply by 3 for each item in the list</span>
</span></span><span class="line"><span class="cl"><span class="c1">#    only if the original number is greater than 2!</span>
</span></span><span class="line"><span class="cl"><span class="c1">#å¯ä»¥åœ¨åé¢åŠ ä¸Šifå‡½æ•°ä»è€Œå¯¹åªç‰¹å®šæ€§çš„é€‰æ‹©æŸäº›å…ƒç´ </span>
</span></span><span class="line"><span class="cl"><span class="n">myList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="s1">&#39;4&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">myNewList</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="mi">3</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">myList</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">myNewList</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>[9, 12]
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># Cool example of how to make two lists into a dictionary using a comprehension!</span>
</span></span><span class="line"><span class="cl"><span class="c1"># å¯ä»¥å°†ä¸€ä¸ªåˆ—è¡¨è½¬å˜ä¸ºä¸€ä¸ªå­—å…¸</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ç”¨åˆ°äº†è§£åŒ…æ–¹æ³•</span>
</span></span><span class="line"><span class="cl"><span class="c1"># å¤–é¢ç›´æ¥æ”¹ä¸ºå¤§æ‹¬å·å°±è¡Œäº†</span>
</span></span><span class="line"><span class="cl"><span class="n">myList1</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;three&#39;</span><span class="p">,</span> <span class="s1">&#39;four&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">myList2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">myDict</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span><span class="n">value</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">myList1</span><span class="p">,</span> <span class="n">myList2</span><span class="p">)}</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">myDict</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>{'one': 1, 'two': 2, 'three': 3, 'four': 4}
</code></pre>
<h3 id="ä½¿ç”¨mapå‡½æ•°">ä½¿ç”¨<code>map()</code>å‡½æ•°</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">##mapå‡½æ•°å¯¹åˆ—è¡¨ä¸­çš„æ¯ä¸ªå…ƒç´ è¿›è¡Œå¤„ç†</span>
</span></span><span class="line"><span class="cl"><span class="n">myList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="s1">&#39;4&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">myList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">myList</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">myList</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>[1, 2, 3, 4]
</code></pre>

    </div>

    





<div class="article-tags">
  
  <a class="badge badge-light" href="/tag/python/">Python</a>
  
</div>



<div class="share-box">
  <ul class="share">
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fjaspershen.github.io%2Fpost%2F2019-12-02-python-for-genomics-class_day06%2F&amp;text=Python&#43;for&#43;genomics&#43;day&#43;06" target="_blank" rel="noopener" class="share-btn-twitter" aria-label="twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fjaspershen.github.io%2Fpost%2F2019-12-02-python-for-genomics-class_day06%2F&amp;t=Python&#43;for&#43;genomics&#43;day&#43;06" target="_blank" rel="noopener" class="share-btn-facebook" aria-label="facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
        
      
      <li>
        <a href="mailto:?subject=Python%20for%20genomics%20day%2006&amp;body=https%3A%2F%2Fjaspershen.github.io%2Fpost%2F2019-12-02-python-for-genomics-class_day06%2F" target="_blank" rel="noopener" class="share-btn-email" aria-label="envelope">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fjaspershen.github.io%2Fpost%2F2019-12-02-python-for-genomics-class_day06%2F&amp;title=Python&#43;for&#43;genomics&#43;day&#43;06" target="_blank" rel="noopener" class="share-btn-linkedin" aria-label="linkedin-in">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="whatsapp://send?text=Python&#43;for&#43;genomics&#43;day&#43;06%20https%3A%2F%2Fjaspershen.github.io%2Fpost%2F2019-12-02-python-for-genomics-class_day06%2F" target="_blank" rel="noopener" class="share-btn-whatsapp" aria-label="whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=https%3A%2F%2Fjaspershen.github.io%2Fpost%2F2019-12-02-python-for-genomics-class_day06%2F&amp;title=Python&#43;for&#43;genomics&#43;day&#43;06" target="_blank" rel="noopener" class="share-btn-weibo" aria-label="weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>











  
  
    



  
  
  
    
  
  
  
  <div class="media author-card content-widget-hr">
    
      
      <a href="https://jaspershen.github.io/"><img class="avatar mr-3 avatar-circle" src="/authors/admin/avatar_hu86242519a21313948ac7dc77e0a27da6_1568301_270x270_fill_q75_lanczos_center.jpg" alt="Xiaotao Shen"></a>
    

    <div class="media-body">
      <h5 class="card-title"><a href="https://jaspershen.github.io/">Xiaotao Shen</a></h5>
      <h6 class="card-subtitle">Postdoctoral Research Fellow</h6>
      <p class="card-text">Metabolomics, Multi-omics, Bioinformatics, Systems Biology.</p>
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="/#contact" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://twitter.com/GeorgeCushen" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://scholar.google.co.uk/citations?user=sIwtMXoAAAAJ" target="_blank" rel="noopener">
        <i class="fas fa-graduation-cap"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/gcushen" target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.linkedin.com/" target="_blank" rel="noopener">
        <i class="fab fa-linkedin"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="/uploads/resume.pdf" >
        <i class="ai ai-cv"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>


  
















  </div>
</article>
  </div>

  <div class="page-footer">
    
    
    <div class="container">
      <footer class="site-footer">

  












  
  
  
  
  













  
  
  

  
  
    
  
  
    
  

  

  
  <p class="powered-by copyright-license-text">
    Â© 2023 Xiaotao Shen
  </p>
  

  <p class="powered-by footer-license-icons">
    <a href="https://creativecommons.org/licenses/by-nc-nd/4.0" rel="noopener noreferrer" target="_blank" aria-label="Creative Commons">
      <i class="fab fa-creative-commons fa-2x" aria-hidden="true"></i>
      <i class="fab fa-creative-commons-by fa-2x" aria-hidden="true"></i>
      
        <i class="fab fa-creative-commons-nc fa-2x" aria-hidden="true"></i>
      
      
        <i class="fab fa-creative-commons-nd fa-2x" aria-hidden="true"></i>
      
    </a>
  </p>





  <p class="powered-by">
    
    
    
      
      
      
      
      
      
      Published with <a href="https://wowchemy.com/?utm_campaign=poweredby" target="_blank" rel="noopener">Wowchemy</a> â€” the free, <a href="https://github.com/wowchemy/wowchemy-hugo-themes" target="_blank" rel="noopener">open source</a> website builder that empowers creators.
    
  </p>
</footer>

    </div>
    
  </div>

  


<script src="/js/vendor-bundle.min.f64289d8217e08e3afcd597d60836062.js"></script>




  

  
  

  













  
  <script id="search-hit-fuse-template" type="text/x-template">
    <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
    </div>
  </script>
  
    <script src="https://cdn.jsdelivr.net/gh/krisk/Fuse@v3.2.1/dist/fuse.min.js" integrity="sha512-o38bmzBGX+hD3JHWUFCDA09btWaqrNmoJ3RXLlrysA7PP01Kgs4UlE4MhelE1v5dJR3+cxlR4qQlotsW7jKsnw==" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/gh/julmot/mark.js@8.11.1/dist/jquery.mark.min.js" integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin="anonymous"></script>
  












  
  
  
  
  
  
  







<script id="page-data" type="application/json">{"use_headroom":true}</script>



  <script src="/js/wowchemy-headroom.db4755770454eb63685f8de785c0a172.js" type="module"></script>









  
  


<script src="/en/js/wowchemy.min.ead4a376bcf2c4714888c770ea9b0040.js"></script>







  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        
        <pre><code></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>


  <script src="/js/wowchemy-publication.68f8d7090562ca65fc6d3cb3f8f2d2cb.js" type="module"></script>


















</body>
</html>
