<!DOCTYPE html>
<!-- This site was created with Wowchemy. https://www.wowchemy.com -->
<!-- Last Published: August 10, 2023 --><html lang="en-us" >


<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  
  
    <meta name="generator" content="Wowchemy 5.7.0 for Hugo" />
  

  
  












  
  










  







  
  
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Bruno+Ace&family=Limelight&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Bruno+Ace&family=Limelight&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" media="print" onload="this.media='all'">
    
  

  
  

  
  
    
    <script src="/js/mathjax-config.js"></script>
  

  

  <link rel="stylesheet" href="/css/vendor-bundle.min.047268c6dd09ad74ba54a0ba71837064.css" media="print" onload="this.media='all'">

  
  
  
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.2/css/academicons.min.css" integrity="sha512-KlJCpRsLf+KKu2VQa5vmRuClRFjxc5lXO03ixZt82HZUk41+1I0bD8KBSA0fY290ayMfWYI9udIqeOWSu1/uZg==" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    
    
    
    
      
      
    
    
    

    
    
    

    

    
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      
      

      
      

      
    
      
      

      
      

      
    
  

  
  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.00f70589ff95c2db8722b74912195f3f.css" />

  
  
  

  
  
  
  
  
  
  
    
    
    <link rel="stylesheet" href="/css/libs/chroma/github-light.min.css" title="hl-light" media="print" onload="this.media='all'" >
    <link rel="stylesheet" href="/css/libs/chroma/dracula.min.css" title="hl-dark" media="print" onload="this.media='all'" disabled>
  

  
  


























  
  
  






  <meta name="author" content="Xiaotao Shen" />





  

<meta name="description" content="Learn how to blog in Academic using Jupyter notebooks" />



<link rel="alternate" hreflang="en-us" href="https://jaspershen.github.io/post/2019-12-02-python-for-genomics-class_day05/" />
<link rel="canonical" href="https://jaspershen.github.io/post/2019-12-02-python-for-genomics-class_day05/" />



  <link rel="manifest" href="/manifest.webmanifest" />



<link rel="icon" type="image/png" href="/media/icon_hu805a85e690e4f2727bf7d5f685d888f7_86836_32x32_fill_lanczos_center_3.png" />
<link rel="apple-touch-icon" type="image/png" href="/media/icon_hu805a85e690e4f2727bf7d5f685d888f7_86836_180x180_fill_lanczos_center_3.png" />

<meta name="theme-color" content="#007C48" />










  






<meta property="twitter:card" content="summary_large_image" />

  <meta property="twitter:site" content="@wowchemy" />
  <meta property="twitter:creator" content="@wowchemy" />
<meta property="twitter:image" content="https://jaspershen.github.io/post/2019-12-02-python-for-genomics-class_day05/featured.png" />
<meta property="og:site_name" content="Xiaotao Shen" />
<meta property="og:url" content="https://jaspershen.github.io/post/2019-12-02-python-for-genomics-class_day05/" />
<meta property="og:title" content="Python for genomics day 05 | Xiaotao Shen" />
<meta property="og:description" content="Learn how to blog in Academic using Jupyter notebooks" /><meta property="og:image" content="https://jaspershen.github.io/post/2019-12-02-python-for-genomics-class_day05/featured.png" /><meta property="og:locale" content="en-us" />

  
    <meta
      property="article:published_time"
      content="2019-12-03T00:00:00&#43;00:00"
    />
  
  
    <meta property="article:modified_time" content="2019-12-03T00:00:00&#43;00:00">
  






    






  




<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://jaspershen.github.io/post/2019-12-02-python-for-genomics-class_day05/"
  },
  "headline": "Python for genomics day 05",
  
  "image": [
    "https://jaspershen.github.io/post/2019-12-02-python-for-genomics-class_day05/featured.png"
  ],
  
  "datePublished": "2019-12-03T00:00:00Z",
  "dateModified": "2019-12-03T00:00:00Z",
  
  "author": {
    "@type": "Person",
    "name": "Xiaotao Shen"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "Xiaotao Shen",
    "logo": {
      "@type": "ImageObject",
      "url": "https://jaspershen.github.io/media/icon_hu805a85e690e4f2727bf7d5f685d888f7_86836_192x192_fill_lanczos_center_3.png"
    }
  },
  "description": "Learn how to blog in Academic using Jupyter notebooks"
}
</script>

  

  




  
  
  

  
  

  


  
  <title>Python for genomics day 05 | Xiaotao Shen</title>

  
  
  
  











</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper   " data-wc-page-id="4b860bc486e698b29ff80680dc950148" >

  
  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.c51bb6301bb2be5edd35b3630c50ed3a.js"></script>

  


<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="Close"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control"
        aria-label="Search...">
        
      </div>

      
      

      

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header header--fixed">
  
  
  
  
  












<header>
  <nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
    <div class="container-xl">

      
      <div class="d-none d-lg-inline-flex">
        <a class="navbar-brand" href="/">Xiaotao Shen</a>
      </div>
      

      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar-content" aria-controls="navbar-content" aria-expanded="false" aria-label="Toggle navigation">
      <span><i class="fas fa-bars"></i></span>
      </button>
      

      
      <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
        <a class="navbar-brand" href="/">Xiaotao Shen</a>
      </div>
      

      
      
      <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

        
        <ul class="navbar-nav d-md-inline-flex">
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#about"><span>ğŸ  About</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#posts"><span>ğŸ“– Posts</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#projects"><span>ğŸ’» Projects</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#talks"><span>ğŸ—£ï¸ Talks</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#featured"><span>ğŸ—ï¸ Publications</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#contact"><span>ğŸ“¥ Contact</span></a>
          </li>

          
          

        

          
        </ul>
      </div>

      <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

        
        
          
            
            <li class="nav-item d-none d-lg-inline-flex">
              <a class="nav-link" href="https://twitter.com/GeorgeCushen" target="_blank" rel="noopener" aria-label="github">
                <i class="fab fa-github" aria-hidden="true"></i>
              </a>
            </li>
          
        

        
        
        
        <li class="nav-item">
          <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        
        
        
        <li class="nav-item dropdown theme-dropdown">
          <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true" aria-label="Display preferences">
            <i class="fas fa-moon" aria-hidden="true"></i>
          </a>
          <div class="dropdown-menu">
            <a href="#" class="dropdown-item js-set-theme-light">
              <span>Light</span>
            </a>
            <a href="#" class="dropdown-item js-set-theme-dark">
              <span>Dark</span>
            </a>
            <a href="#" class="dropdown-item js-set-theme-auto">
              <span>Automatic</span>
            </a>
          </div>
        </li>
        

        
        

      </ul>

    </div>
  </nav>
</header>


  </div>

  <div class="page-body">
    
    
    

    <article class="article">

  






















  
  


<div class="article-container pt-3">
  <h1>Python for genomics day 05</h1>

  
  <p class="page-subtitle">Learn how to blog in Academic using Jupyter notebooks</p>
  

  


<div class="article-metadata">

  
  
  
  
  <div>
    

  <span class="author-highlighted">
      Xiaotao Shen</span>
  </div>
  
  

  
  <span class="article-date">
    
    
      
    
    Dec 3, 2019
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    8 min read
  </span>
  

  
  
  
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="/category/python/">Python</a></span>
  

</div>

  





</div>


<div class="article-header article-container featured-image-wrapper mt-4 mb-4" style="max-width: 720px; max-height: 407px;">
  <div style="position: relative">
    <img src="/post/2019-12-02-python-for-genomics-class_day05/featured_hub2df554e8ed229a2f4f490aa58d08812_709133_720x2500_fit_q75_h2_lanczos_3.webp" width="720" height="407" alt="" class="featured-image">
    
  </div>
</div>



  <div class="article-container">

    <div class="article-style">
      <details class="toc-inpage d-print-none  " open>
  <summary class="font-weight-bold">Table of Contents</summary>
  <nav id="TableOfContents">
  <ul>
    <li><a href="#name">name</a></li>
    <li><a href="#sequence">Sequence</a></li>
    <li><a href="#comment">Comment</a></li>
    <li><a href="#quality">Quality</a></li>
  </ul>

  <ul>
    <li><a href="#column-headings">column headings</a></li>
  </ul>
</nav>
</details>
<p>ç¬¬äº”å¤©çš„çŸ¥è¯†ç‚¹æ€»ç»“.</p>
<h1 id="fastqæ ¼å¼æ•°æ®">FASTQæ ¼å¼æ•°æ®</h1>
<p>Fastqæ˜¯æµ‹åºæ•°æ®ä¸‹æœºæ ¼å¼ï¼Œå…¶ä¸­åŒ…å«æµ‹åºåºåˆ—(reads)çš„åºåˆ—ä¿¡æ¯åŠå…¶å¯¹åº”çš„æµ‹åºè´¨é‡ä¿¡æ¯ã€‚FASTQæ ¼å¼æ–‡ä»¶ä¸­æ¯ä¸ªreadç”±å››è¡Œ(name,sequence,comment,quality)æè¿°ï¼Œå¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">@YJM244_SRR800767.1 1 length=202      
</span></span><span class="line"><span class="cl">TGTGAAACTTAGTTTTCTTTTTGTATTGGGGTGTAATTTCTTATTTTCCCTGTATTTCACCGCATGCAA      
</span></span><span class="line"><span class="cl">+YJM244 : Geographic Location of Isolate: Romania, Source: Clinical      
</span></span><span class="line"><span class="cl">CC@FDDFFHHHHHJJJJJJIIIJFHJGJJJJ:DCDDGHIJJG4DGIDGH&lt;9??9=F@))B8-&#39;&#39;557=A)? 
</span></span></code></pre></div><p>æœ€å¼€å§‹,æ¡‘æ ¼ç ”ç©¶æ‰€çš„FASTQæ ¼å¼å…è®¸åºåˆ—ä¸è´¨é‡ä¿¡æ¯åˆ†æˆå¤šè¡Œè¿›è¡Œä¿å­˜,ä½†æ˜¯ä¸€èˆ¬ä¸æ¨èé‡‡ç”¨è¿™ç§æ–¹å¼,å› ä¸ºç¬¬ä¸€å’Œç¬¬ä¸‰è¡Œå¼€å¤´çš„@ä¸+ç¬¦å·åŒæ ·ä¹Ÿå¯èƒ½å‡ºç°åœ¨è´¨é‡ä¿¡æ¯ä¸­,å¯èƒ½ä¼šé€ æˆä¿¡æ¯æå–çš„å›°éš¾.</p>
<h2 id="name">name</h2>
<p>å…¶ä¸­ç¬¬ä¸€è¡Œæ˜¯è¯¥readçš„name,ä»¥â€œ@â€å¼€å¤´ï¼Œéšåä¸ºIllumina æµ‹åºæ ‡è¯†ç¬¦(Sequence Identifiers)å’Œæè¿°æ–‡å­—(é€‰æ‹©æ€§éƒ¨åˆ†).ä¸åŒçš„å…¬å¸æˆ–è€…è½¯ä»¶ä¸å¤ªä¸€æ ·.ä»–æ˜¯æ¯ä¸€æ¡readçš„å”¯ä¸€æ ‡è¯†ç¬¦,åŒä¸€ä»½FASTQæ–‡ä»¶ä¸­ä¸ä¼šå‡ºç°é‡å¤,ç”šè‡³ä¸åŒçš„FASTQçš„æ–‡ä»¶ä¸­ä¹Ÿä¸ä¼šå‡ºç°é‡å¤.</p>
<p>ä»¥ä¸‹é¢çš„ä¸ºä¾‹:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">@HWUSI-EAS100R:6:73:941:1973#0/1
</span></span></code></pre></div><table>
<thead>
<tr>
<th>Identifier</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>HWUSI-EAS100R</td>
<td>the unique instrument name</td>
</tr>
<tr>
<td>6</td>
<td>flowcell lane</td>
</tr>
<tr>
<td>73</td>
<td>tile number within the flowcell lane</td>
</tr>
<tr>
<td>941</td>
<td>&lsquo;x&rsquo;-coordinate of the cluster within the tile</td>
</tr>
<tr>
<td>1973</td>
<td>&lsquo;y&rsquo;-coordinate of the cluster within the tile</td>
</tr>
<tr>
<td>#0</td>
<td>index number for a multiplexed sample (0 for no indexing)</td>
</tr>
<tr>
<td>/1</td>
<td>the member of a pair, /1 or /2 (paired-end or mate-pair reads only)</td>
</tr>
</tbody>
</table>
<h2 id="sequence">Sequence</h2>
<p>ç¬¬äºŒè¡Œæ˜¯ç¢±åŸºåºåˆ—.ç”±A,C,T,C.Näº”ä¸ªå­—æ¯ç»„æˆ,è¿™ä¹Ÿæ˜¯æˆ‘ä»¬çœŸæ­£å…³å¿ƒçš„DNAåºåˆ—,NAä»£è¡¨çš„æ˜¯é‚£äº›æ— æ³•è¢«è¯†åˆ«å‡ºæ¥çš„ç¢±åŸº.</p>
<h2 id="comment">Comment</h2>
<p>ç¬¬ä¸‰è¡Œä»¥â€œ+â€å¼€å¤´ï¼Œåœ¨æ—§ç‰ˆçš„FASTQæ–‡ä»¶ä¸­,ä¼šç›´æ¥èµ‹å€¼ç¬¬ä¸€è¡Œçš„ä¿¡æ¯,ä½†æ˜¯ç°åœ¨ä¸€èˆ¬ä»€ä¹ˆéƒ½ä¸åŠ ,ç”¨ä»¥èŠ‚çœå­˜å‚¨ç©ºé—´.</p>
<h2 id="quality">Quality</h2>
<p>ç¬¬å››è¡Œæ˜¯å¯¹åº”åºåˆ—çš„æµ‹åºè´¨é‡ã€‚æ˜¯å’Œç¬¬äºŒè¡Œçš„sequenceä¸€ä¸€å¯¹åº”çš„,æ‰€ä»¥ç¬¬å››è¡Œå’Œç¬¬äºŒè¡Œçš„é•¿åº¦å¿…é¡»ç›¸ç­‰.ç¬¬å››è¡Œä¸­æ¯ä¸ªå­—ç¬¦å¯¹åº”çš„ASCIIå€¼å‡å»33ï¼Œå³ä¸ºç¬¬äºŒè¡Œå¯¹åº”ç¢±åŸºè´¨é‡ã€‚ç”¨æ¥æè¿°æ¯ä¸ªæµ‹åºç¢±åŸºçš„å¯é ç¨‹åº¦,ç”¨ASCIIç è¡¨ç¤º.</p>
<p>FASTQæ ¼å¼ä¸­è´¨é‡å€¼å…·æœ‰é‡è¦çš„ä½œç”¨ï¼Œåœ¨å¾ˆå¤šçš„åˆ†æä¸­ä¼šç”¨åˆ°è¿™ä¸ªè´¨é‡å€¼ï¼Œä¾‹å¦‚æ•°æ®è´¨æ§ï¼Œæ•°æ®è¿‡æ»¤ï¼Œåºåˆ—æ‹¼æ¥ï¼ŒçŸ­åºåˆ—æ¯”å¯¹ï¼Œå˜å¼‚æ£€æµ‹ä¸­éƒ½è¦ç”¨åˆ°è¿™ä¸ªè´¨é‡å€¼ã€‚
è¿™ä¸ªè´¨é‡å€¼æ˜¯åŸºäºphredè´¨é‡å€¼ä½“ç³».</p>
<p>ä½†æ˜¯ç”±äºå•ä¸ªç¢±åŸºæ— æ³•ä¸ä¸¤ä½çš„è´¨é‡å€¼ç›¸åŒ¹é…ï¼Œä¾‹å¦‚Aç¢±åŸºå¯¹åº”çš„è´¨é‡å€¼ä¸º40ï¼Œä¸€ä¸ªAå­—ç¬¦å¯¹åº”ä¸¤ä¸ªå­—ç¬¦40ï¼Œå› æ­¤éœ€è¦å°†åŸå§‹è´¨é‡å€¼åŠ ä¸Š33æˆ–è€…64ï¼Œåœ¨è½¬æ¢ä¸ºå¯¹åº”çš„ASCIIç å€¼ï¼Œä¸ºä½•åŠ 33ï¼Œå› ä¸º33ä»¥ä¸‹ASCIIç æ— æ³•ç”¨é”®ç›˜å­—ç¬¦è¡¨ç¤ºå‡ºæ¥ã€‚illuminaæµ‹åº1.8ç‰ˆæœ¬ä»¥ä¸ŠåŠ 33ï¼Œä»¥ä¸‹åŠ 64ã€‚</p>
<p>è´¨é‡è¯„åˆ†(quality score,Q-score)æ˜¯ä¸€ä¸ªç¢±åŸºçš„é”™è¯¯æ¦‚ç‡çš„å¯¹æ•°å€¼ã€‚ç”±phredç¨‹åºçš„å¼€å‘è€…å®šä¹‰,ä¸€èˆ¬å¯ä»¥ç§°ä¹‹ä¸ºphred quality,</p>
<p>å¦‚æœæµ‹åºé”™è¯¯ç‡ç”¨eè¡¨ç¤ºï¼ŒIlluminaæµ‹åºå¹³å°çš„ç¢±åŸºè´¨é‡å€¼ç”¨Qphredè¡¨ç¤ºï¼Œåˆ™æœ‰ä¸‹åˆ—å…³ç³»ï¼š</p>
<p>$ASCII - 33 = Qphredã€€=ã€€-10log10(e)$</p>
<p>æ­¤å…¬å¼å¯è¯´æ˜ï¼Œquality scoreè¶Šå¤§æµ‹åºé”™è¯¯ç‡(e)è¶Šä½ï¼Œå‡†ç¡®æ€§è¶Šé«˜.</p>
<p>A quality score (or Q-score) expresses an error probability. In particular, it serves as a convenient and compact way to communicate very small error probabilities.</p>
<p>Given an assertion, A, the quality score, Q(A), expresses the probability that A is not true, P(~A), according to the relationship:</p>
<p>Q(A) =-10 log10(P(~A))</p>
<p>where P(~A) is the estimated probability of an assertion A being wrong.</p>
<p><a href="https://support.illumina.com/help/BaseSpace_OLH_009008/Content/Source/Informatics/BS/QualityScores_swBS.htm" target="_blank" rel="noopener">https://support.illumina.com/help/BaseSpace_OLH_009008/Content/Source/Informatics/BS/QualityScores_swBS.htm</a></p>
<p>ç¢±åŸºçš„quality scoreæ˜¯æ€ä¹ˆæ¥çš„å‘¢?</p>
<p>Phredæœ€åˆæ˜¯ä¸€ä¸ªä»æµ‹åºä»ªä¸­äº§ç”Ÿçš„è§å…‰è®°å½•æ•°æ®ä¸­è¯†åˆ«ç¢±åŸºçš„ç¨‹åºã€‚åœ¨æ—©æœŸçš„è§å…‰æŸ“æ–™æµ‹åºä¸­ï¼Œæ¯æ¬¡å‘ç”Ÿç¢±åŸºåˆæˆæ—¶ä¼šé‡Šæ”¾å‡ºè§å…‰ä¿¡å·ï¼Œè¯¥ä¿¡å·è¢«CCDå›¾åƒä¼ æ„Ÿå™¨æ•è·ã€‚è®°å½•ä¸‹è§å…‰ä¿¡å·çš„å³°å€¼ï¼Œç”Ÿæˆä¸€ä¸ªå®æ—¶çš„è½¨è¿¹æ•°æ®ï¼ˆchromatogramï¼‰ã€‚å› ä¸ºä¸åŒçš„ç¢±åŸºç”¨ä¸ç”¨çš„é¢œè‰²æ ‡è®°ï¼Œæ£€æµ‹è¿™äº›å³°å€¼å³å¯åˆ¤æ–­å‡ºå¯¹åº”çš„ç¢±åŸºã€‚ä½†ç”±äºè¿™äº›ä¿¡å·çš„æ³¢å³°ã€å¯†åº¦ã€å½¢çŠ¶å’Œä½ç½®ç­‰æ˜¯ä¸è¿ç»­æˆ–æ¨¡ç³Šçš„ï¼Œæœ‰æ—¶å¾ˆéš¾æ ¹æ®æ³¢å³°åˆ¤æ–­å‡ºæ­£ç¡®çš„ç¢±åŸºã€‚</p>
<p>Phredè®¡ç®—è®¸å¤šä¸æ³¢å³°å¤§å°å’Œåˆ†è¾¨ç‡ç›¸å…³çš„å‚æ•°ï¼Œæ ¹æ®è¿™äº›å‚æ•°ï¼Œä»ä¸€ä¸ªå·¨å¤§çš„æŸ¥è¯¢è¡¨ä¸­æ‰¾å‡ºç¢±åŸºè´¨é‡å¾—åˆ†ã€‚è¿™ä¸ªæŸ¥è¯¢è¡¨æ˜¯æ ¹æ®å¯¹å·²çŸ¥åºåˆ—çš„æµ‹åºæ•°æ®åˆ†æå¾—åˆ°çš„ï¼ˆåº”è¯¥æ˜¯åˆ†æå¾—åˆ°æ³¢å³°å‚æ•°ä¸ç¢±åŸºé”™è¯¯ç‡çš„å…³ç³»ï¼Œå†é€šè¿‡å…¬å¼æŠŠé”™è¯¯ç‡è½¬æ¢æˆè´¨é‡å¾—åˆ†ï¼Œå¾—åˆ°æ³¢å³°å‚æ•°ä¸è´¨é‡å¾—åˆ†çš„ç›´æ¥å¯¹åº”è¡¨ï¼‰ã€‚ä¸åŒçš„æµ‹åºè¯•å‰‚å’Œæœºå™¨ç”¨ä¸åŒçš„æŸ¥è¯¢è¡¨ã€‚ä¸ºäº†èŠ‚çº¦ç£ç›˜ç©ºé—´ï¼Œè´¨é‡å¾—åˆ†ï¼ˆå¯èƒ½å ç”¨ä¸¤ä¸ªå­—ç¬¦ï¼‰æŒ‰ä¸€å®šè§„åˆ™ï¼ˆPhred+33æˆ–Phred+64ï¼‰è¢«è½¬æ¢ä¸ºå•ä¸ªå­—ç¬¦è¡¨ç¤ºã€‚</p>
<p>ç¢±åŸºé”™è¯¯ç‡å’Œè´¨é‡å¾—åˆ†çš„å…³ç³»ç”±å¦‚ä¸‹ä¸¤ç§:</p>
<p>$Qphred = -10*log10(p)$</p>
<p>$Qillumina-prior to v.1.4 = -10log10(p/(1-p))$</p>
<h1 id="è¯»å–fastqæ•°æ®">è¯»å–FASTQæ•°æ®</h1>
<p>é¦–å…ˆå®šä¹‰è¯»å–FASTQæ•°æ®çš„å‡½æ•°.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">seq_list_from_fastq_file</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
</span></span><span class="line"><span class="cl"><span class="s1">&#39;&#39;&#39;
</span></span></span><span class="line"><span class="cl"><span class="s1">this function only get the sequence and quality informaton
</span></span></span><span class="line"><span class="cl"><span class="s1">&#39;&#39;&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">seq_list</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="n">quality_list</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">FASTQ_INPUT</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">line_cnt</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">FASTQ_INPUT</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">line_cnt</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">line_cnt</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">seq_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">line_cnt</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">quality_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">                <span class="n">line_cnt</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">seq_list</span><span class="p">,</span> <span class="n">quality_list</span>
</span></span></code></pre></div><p>è¯»å–ä¸€ä¸ªå®ä¾‹æ•°æ®
ä¸‹å›¾æ˜¯è¯¥æ•°æ®çš„æˆªå›¾.å¯ä»¥çœ‹åˆ°commenté™¤äº†<code>+</code>æ„å¤–,æ²¡æœ‰ä»»ä½•å†…å®¹.</p>
<p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="" srcset="
               /post/2019-12-02-python-for-genomics-class_day05/fastq_hu01dd903fa8b85efdfbf59e037ccc0293_45093_90430675a47ae4410cfececbf8bae391.webp 400w,
               /post/2019-12-02-python-for-genomics-class_day05/fastq_hu01dd903fa8b85efdfbf59e037ccc0293_45093_97c5d128798543933d73d1c9124b9591.webp 760w,
               /post/2019-12-02-python-for-genomics-class_day05/fastq_hu01dd903fa8b85efdfbf59e037ccc0293_45093_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
               src="/post/2019-12-02-python-for-genomics-class_day05/fastq_hu01dd903fa8b85efdfbf59e037ccc0293_45093_90430675a47ae4410cfececbf8bae391.webp"
               width="670"
               height="585"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># FASTQ from ChIP-seq experiment ENCSR784FYS</span>
</span></span><span class="line"><span class="cl"><span class="c1"># file accession ENCFF733YBM</span>
</span></span><span class="line"><span class="cl"><span class="n">fastq_filename</span> <span class="o">=</span> <span class="s1">&#39;ENCFF733YBM-trunc.fastq&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">sequence</span><span class="p">,</span> <span class="n">quality</span> <span class="o">=</span> <span class="n">seq_list_from_fastq_file</span><span class="p">(</span><span class="n">fastq_filename</span><span class="p">)</span>
</span></span></code></pre></div><p>å°†è¯»å–åˆ°çš„sequenceå’Œqualityä¿¡æ¯æ‰“å°å‡ºæ¥.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># string at index 0 of list</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Length of sequence list = &#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">),</span> <span class="s1">&#39;,</span><span class="se">\t</span><span class="s1">First sequence = </span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">,</span> \
</span></span><span class="line"><span class="cl">      <span class="n">sequence</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Length of quality list  = &#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">quality</span><span class="p">),</span>  <span class="s1">&#39;,</span><span class="se">\t</span><span class="s1">First quality  = </span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">,</span> \
</span></span><span class="line"><span class="cl">      <span class="n">quality</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>Length of sequence list = 100,	First sequence = 'GGCCGCCGCCCGAGTTCTGCGTACGAGAAGAAAGACGCGG'
Length of quality list  = 100,	First quality  = '&lt;B/&lt;BFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'
</code></pre>
<p>å¯ä»¥çœ‹åˆ°è¯¥æ–‡ä»¶ä¸€å…±æœ‰100æ¡readä¿¡æ¯.æ ¹æ®å¯¹ç¢±åŸºè´¨é‡çš„å®šä¹‰,æˆ‘ä»¬å¯ä»¥æŠŠç¬¬ä¸€ä¸ªreadçš„æ¯ä¸ªç¢±åŸºçš„quality scoreæ‰“å°å‡ºæ¥.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># take apart quality value encoding</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sequence</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">x</span><span class="p">],</span> 
</span></span><span class="line"><span class="cl">                                              <span class="n">quality</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">x</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                                              <span class="nb">ord</span><span class="p">(</span><span class="n">quality</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">x</span><span class="p">])</span> <span class="o">-</span> <span class="mi">33</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                              <span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">quality</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">x</span><span class="p">])</span> <span class="o">-</span> <span class="mi">33</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                              <span class="nb">pow</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">quality</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">x</span><span class="p">])</span> <span class="o">-</span> <span class="mi">33</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">0.1</span> <span class="p">)))</span>
</span></span></code></pre></div><pre><code>G	&lt;	27	-2.7	0.001995262314968879
G	B	33	-3.3000000000000003	0.000501187233627272
C	/	14	-1.4000000000000001	0.03981071705534971
C	&lt;	27	-2.7	0.001995262314968879
G	B	33	-3.3000000000000003	0.000501187233627272
C	F	37	-3.7	0.00019952623149688788
C	F	37	-3.7	0.00019952623149688788
G	F	37	-3.7	0.00019952623149688788
C	F	37	-3.7	0.00019952623149688788
C	F	37	-3.7	0.00019952623149688788
C	F	37	-3.7	0.00019952623149688788
G	F	37	-3.7	0.00019952623149688788
A	F	37	-3.7	0.00019952623149688788
G	F	37	-3.7	0.00019952623149688788
T	F	37	-3.7	0.00019952623149688788
T	F	37	-3.7	0.00019952623149688788
C	F	37	-3.7	0.00019952623149688788
T	F	37	-3.7	0.00019952623149688788
G	F	37	-3.7	0.00019952623149688788
C	F	37	-3.7	0.00019952623149688788
G	F	37	-3.7	0.00019952623149688788
T	F	37	-3.7	0.00019952623149688788
A	F	37	-3.7	0.00019952623149688788
C	F	37	-3.7	0.00019952623149688788
G	F	37	-3.7	0.00019952623149688788
A	F	37	-3.7	0.00019952623149688788
G	F	37	-3.7	0.00019952623149688788
A	F	37	-3.7	0.00019952623149688788
A	F	37	-3.7	0.00019952623149688788
G	F	37	-3.7	0.00019952623149688788
A	F	37	-3.7	0.00019952623149688788
A	F	37	-3.7	0.00019952623149688788
A	F	37	-3.7	0.00019952623149688788
G	F	37	-3.7	0.00019952623149688788
A	F	37	-3.7	0.00019952623149688788
C	F	37	-3.7	0.00019952623149688788
G	F	37	-3.7	0.00019952623149688788
C	F	37	-3.7	0.00019952623149688788
G	F	37	-3.7	0.00019952623149688788
G	F	37	-3.7	0.00019952623149688788
</code></pre>
<p>å†çœ‹ä¸€ä¸‹quality scoreçš„è®¡ç®—åŠæ³•.</p>
<p>æ¯ä¸ªç¢±åŸºçš„quality scoreéƒ½æ˜¯ä½¿ç”¨ä¸€ä¸ªASCIIå­—ç¬¦æ¥è¡¨ç¤ºçš„.
æ¯”å¦‚ç¬¬ä¸€ä¸ªreadçš„è´¨é‡:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">quality</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">quality</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span></code></pre></div><pre><code>'&lt;'
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nb">ord</span><span class="p">(</span><span class="n">quality</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</span></span></code></pre></div><pre><code>60
</code></pre>
<p>ç¬¬ä¸€ä¸ªç¢±åŸºçš„quality scoreçš„å­—ç¬¦æ˜¯<code>&lt;</code>,ordå‡½æ•°æ˜¯ç”¨æ¥è¿”å›ä¸€ä¸ªå­—ç¬¦çš„unicode code.æ‰€ä»¥å¯¹äºæŸä¸ªç¢±åŸº,ä»–çš„quality scoreå°±æ˜¯<code>ord(quality) - 33</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">help</span><span class="p">(</span><span class="nb">ord</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>Help on built-in function ord in module builtins:

ord(c, /)
    Return the Unicode code point for a one-character string.
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">sequence</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="c1">#ç¢±åŸº</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">quality</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="c1">#ç¢±åŸºè´¨é‡å­—ç¬¦</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">quality</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="mi">33</span><span class="p">)</span><span class="c1">#ç¢±åŸºquality score</span>
</span></span></code></pre></div><pre><code>G
&lt;
60
27
</code></pre>
<p>ä¸‹é¢æˆ‘ä»¬ç”¨quality scoreè¿™ä¸ªç¢±åŸºé”™è¯¯çš„æ¦‚ç‡å€¼.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">qs</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">quality</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="mi">33</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">qs</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">qs</span> <span class="o">*</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">pow</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="n">qs</span> <span class="o">*</span> <span class="o">-</span><span class="mf">0.1</span> <span class="p">))</span>
</span></span></code></pre></div><pre><code>27
-2.7





0.001995262314968879
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">help</span><span class="p">(</span><span class="nb">pow</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>Help on built-in function pow in module builtins:

pow(x, y, z=None, /)
    Equivalent to x**y (with two arguments) or x**y % z (with three arguments)
    
    Some types, such as ints, are able to use a more efficient algorithm when
    invoked using the three argument form.
</code></pre>
<p>å¯ä»¥çœ‹åˆ°è¯¥ç¢±åŸºé”™è¯¯çš„æ¦‚ç‡ä¸º0.001995.ä¹Ÿå°±æ˜¯è¯´,é”™è¯¯æ¦‚ç‡è¶Šå°,quality scoreè¶Šå¤§.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># a little easier to view with just the unique characters</span>
</span></span><span class="line"><span class="cl"><span class="n">quality_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">quality</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">quality_set</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># add float and scientific notation to output of probability</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;char</span><span class="se">\t</span><span class="s1">ASCII</span><span class="se">\t</span><span class="s1">qual</span><span class="se">\t</span><span class="s1">exponent</span><span class="se">\t</span><span class="s1">prob&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">quality_set</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{:f}</span><span class="se">\t</span><span class="si">{:e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                        <span class="nb">ord</span><span class="p">(</span><span class="n">x</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                                        <span class="nb">ord</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">33</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                        <span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">33</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                        <span class="nb">pow</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">33</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">0.1</span> <span class="p">)))</span>
</span></span></code></pre></div><pre><code>{'/', 'B', '&lt;', 'F'}
char	ASCII	qual	exponent	prob
/	47	14	-1.400000	3.981072e-02
B	66	33	-3.300000	5.011872e-04
&lt;	60	27	-2.700000	1.995262e-03
F	70	37	-3.700000	1.995262e-04
</code></pre>
<p>ä¸Šé¢è¿™æ®µä»£ç å±•ç¤ºäº†å‡ ç§åœ¨ç¬¬ä¸€ä¸ªreadä¸­,å‡ ç§qualityçš„å­—ç¬¦æ‰€ä»£è¡¨çš„ASCII code,ä»¥åŠé”™è¯¯ç‡.</p>
<p>å®Œæ•´çš„ASCII tabeå¯ä»¥çœ‹è¿™é‡Œ.
<a href="https://www.cs.cmu.edu/~pattis/15-1XX/common/handouts/ascii.html" target="_blank" rel="noopener">https://www.cs.cmu.edu/~pattis/15-1XX/common/handouts/ascii.html</a></p>
<p>æˆ‘ä»¬åœ¨è®¡ç®—ä¸€ä¸ª,å¦‚æœçŸ¥é“é”™è¯¯ç‡,é‚£ä¹ˆå¾—åˆ°çš„å­—ç¬¦åº”è¯¥æ˜¯ä»€ä¹ˆ.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># more exploring</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">math</span> <span class="k">as</span> <span class="nn">math</span>
</span></span><span class="line"><span class="cl"><span class="n">quality_prob</span> <span class="o">=</span> <span class="mf">1.995262e-04</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;math.log():</span><span class="se">\t\t</span><span class="s1">&#39;</span><span class="p">,</span>                   <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">quality_prob</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;int(math.log()):</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span>            <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">quality_prob</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mi">10</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;chr(int(math.log())):</span><span class="se">\t\&#39;</span><span class="s1">&#39;</span><span class="p">,</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">quality_prob</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mi">10</span><span class="p">)),</span> <span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>math.log():		 37.000000685570285
int(math.log()):	 37
chr(int(math.log())):	'%'
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;chr(int(math.log()) + 33):</span><span class="se">\t\&#39;</span><span class="s1">&#39;</span><span class="p">,</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">quality_prob</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="mi">33</span><span class="p">),</span> <span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>chr(int(math.log()) + 33):	'F'
</code></pre>
<h1 id="å¦ä¸€ç§è¯»å–fastqæ•°æ®çš„æ–¹æ³•">å¦ä¸€ç§è¯»å–FASTQæ•°æ®çš„æ–¹æ³•</h1>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">ks</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;sequence&#39;</span><span class="p">,</span> <span class="s1">&#39;optional&#39;</span><span class="p">,</span> <span class="s1">&#39;quality&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">process_lines</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;&#39;&#39;
</span></span></span><span class="line"><span class="cl"><span class="s1">    process a group of 4 lines from fastq file
</span></span></span><span class="line"><span class="cl"><span class="s1">    dividing them into dictionary, with a key for each category
</span></span></span><span class="line"><span class="cl"><span class="s1">    &#39;&#39;&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">record</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">        <span class="n">record</span><span class="p">[</span><span class="n">ks</span><span class="p">[</span><span class="n">x</span><span class="p">]]</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">record</span>
</span></span></code></pre></div><p>é¦–å…ˆå®šä¹‰ä¸€ä¸ªè¯»å–æ¯ä¸ªreadçš„å‡½æ•°.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">fastq_dictionary</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fastq_filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">FASTQ_INPUT</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">line_cnt</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="n">output_lines</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">FASTQ_INPUT</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">line_cnt</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">line_cnt</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">record_dict</span> <span class="o">=</span> <span class="n">process_lines</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">line_cnt</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">            <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">            <span class="n">output_lines</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">output_lines</span> <span class="o">&lt;</span> <span class="mi">7</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="nb">print</span><span class="p">(</span><span class="n">record_dict</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">fastq_dictionary</span><span class="p">[</span><span class="n">record_dict</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">record_dict</span>
</span></span></code></pre></div><pre><code>{'name': '@D00611:288:C9C4PANXX:2:2202:1501:2192 1:N:0:0', 'sequence': 'GGCCGCCGCCCGAGTTCTGCGTACGAGAAGAAAGACGCGG', 'optional': '+', 'quality': '&lt;B/&lt;BFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'}
{'name': '@D00611:288:C9C4PANXX:2:2202:1586:2227 1:N:0:0', 'sequence': 'GCACGCCGACAGCGAGGGAAGGGAGGAGGAGGGAGACGCG', 'optional': '+', 'quality': '&lt;&lt;/&lt;&lt;B/FFFFFFFBFFFBFFFFFFFBFF/FFBFFFFFFF'}
{'name': '@D00611:288:C9C4PANXX:2:2202:1699:2242 1:N:0:0', 'sequence': 'CCTTTTTTAGCAATGACCCAAATACTTGTTCAGAAATTAG', 'optional': '+', 'quality': '&lt;B/&lt;BFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'}
{'name': '@D00611:288:C9C4PANXX:2:2202:1848:2207 1:N:0:0', 'sequence': 'TGGTATTTATAGAGTAAGGAGTTGCCTCTTCTAAGAAGGG', 'optional': '+', 'quality': '&lt;B/&lt;BFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'}
{'name': '@D00611:288:C9C4PANXX:2:2202:1917:2221 1:N:0:0', 'sequence': 'GATCGGAAGAGCACACGTCTCGTATGCCGTCTTCTGCTTG', 'optional': '+', 'quality': '&lt;&lt;&lt;&lt;&lt;&lt;&lt;F&lt;FB&lt;FFFFFFFF/BFFFFFFFFFFFFFBFFF&lt;'}
{'name': '@D00611:288:C9C4PANXX:2:2202:1953:2230 1:N:0:0', 'sequence': 'CTTTCTCCTGTCTCAGGTGACCAAGAATATGGCCCAGGTG', 'optional': '+', 'quality': '&lt;&lt;/&lt;&lt;FBFFFFFFBFFFFFFFFFFFFFFFFFF&lt;FFFFFFF'}
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fastq_dictionary</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">fastq_dictionary</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="n">fastq_dictionary</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">fastq_dictionary</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]]</span>
</span></span></code></pre></div><pre><code>100
dict_keys(['@D00611:288:C9C4PANXX:2:2202:1501:2192 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:1586:2227 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:1699:2242 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:1848:2207 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:1917:2221 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:1953:2230 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:1787:2250 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:2095:2230 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:2296:2185 1:Y:0:0', '@D00611:288:C9C4PANXX:2:2202:2372:2192 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:3089:2192 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:3235:2205 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:3006:2209 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:3276:2220 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:3530:2181 1:Y:0:0', '@D00611:288:C9C4PANXX:2:2202:3628:2193 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:3614:2206 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:4033:2192 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:4186:2218 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:4130:2219 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:4201:2236 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:4065:2240 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:4081:2245 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:4331:2209 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:4628:2230 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:4570:2244 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:4768:2186 1:Y:0:0', '@D00611:288:C9C4PANXX:2:2202:5165:2217 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:5406:2197 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:5733:2194 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:5618:2239 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:5995:2220 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:6095:2222 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:6170:2241 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:6261:2196 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:6395:2231 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:6642:2202 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:6547:2249 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:6870:2238 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:7035:2220 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:7395:2192 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:7336:2215 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:7473:2235 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:8050:2179 1:Y:0:0', '@D00611:288:C9C4PANXX:2:2202:8239:2188 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:8005:2191 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:8139:2200 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:8096:2216 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:8459:2200 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:8364:2206 1:Y:0:0', '@D00611:288:C9C4PANXX:2:2202:8265:2216 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:8519:2237 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:8635:2239 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:9166:2216 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:9103:2220 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:9364:2224 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:9707:2181 1:Y:0:0', '@D00611:288:C9C4PANXX:2:2202:9748:2215 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:9558:2248 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:10105:2194 1:Y:0:0', '@D00611:288:C9C4PANXX:2:2202:10298:2193 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:10376:2209 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:10728:2245 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:10624:2249 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:10894:2186 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:10857:2226 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:10756:2250 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:11123:2222 1:Y:0:0', '@D00611:288:C9C4PANXX:2:2202:11406:2198 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:11675:2186 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:11873:2196 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:11829:2239 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:12090:2181 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:12190:2185 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:12449:2216 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:12301:2219 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:12319:2234 1:Y:0:0', '@D00611:288:C9C4PANXX:2:2202:12354:2246 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:12965:2208 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:12947:2215 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:12928:2221 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:13024:2177 1:Y:0:0', '@D00611:288:C9C4PANXX:2:2202:13052:2183 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:13113:2202 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:13163:2212 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:13415:2203 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:13560:2193 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:13577:2214 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:13701:2226 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:13561:2228 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:13571:2246 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:13942:2178 1:Y:0:0', '@D00611:288:C9C4PANXX:2:2202:13948:2195 1:Y:0:0', '@D00611:288:C9C4PANXX:2:2202:13885:2220 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:13796:2224 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:13837:2236 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:14097:2186 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:14026:2199 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:14242:2220 1:N:0:0', '@D00611:288:C9C4PANXX:2:2202:14052:2226 1:N:0:0'])





{'name': '@D00611:288:C9C4PANXX:2:2202:1501:2192 1:N:0:0',
 'sequence': 'GGCCGCCGCCCGAGTTCTGCGTACGAGAAGAAAGACGCGG',
 'optional': '+',
 'quality': '&lt;B/&lt;BFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'}
</code></pre>
<p>è¿™æ®µä»£ç ,å°†FASTQæ–‡ä»¶è¯»æˆä¸€ä¸ªdictä¸­,æ¯ä¸ªreadåˆæ˜¯å…¶ä¸­ä¸€ä¸ªdict.ç„¶åæœ‰å››ä¸ªkey.</p>
<h1 id="bed-file-formatæ•°æ®">BED file formatæ•°æ®</h1>
<p>This format is used to provide called peaks of signal enrichment based on pooled, normalized (interpreted) data. It is a BED6+4 format.</p>
<ol>
<li>chrom - Name of the chromosome (or contig, scaffold, etc.).</li>
<li>chromStart - The starting position of the feature in the
chromosome or scaffold. The first base in a chromosome is numbered 0.</li>
<li>chromEnd - The ending position of the feature in the chromosome
or scaffold. The chromEnd base is not included in the display of the
feature. For example, the first 100 bases of a chromosome are
defined as chromStart=0, chromEnd=100, and span the bases numbered
0-99.</li>
<li>name - Name given to a region (preferably unique). Use &ldquo;.&rdquo; if no
name is assigned.</li>
<li>score - Indicates how dark the peak will be displayed in the
browser (0-1000). If all scores were &ldquo;&lsquo;0&rdquo;&rsquo; when the data were
submitted to the DCC, the DCC assigned scores 1-1000 based on signal
value. Ideally the average signalValue per base spread is between
100-1000.</li>
<li>strand - +/- to denote strand or orientation (whenever
applicable). Use &ldquo;.&rdquo; if no orientation is assigned.</li>
<li>signalValue - Measurement of overall (usually, average)
enrichment for the region.</li>
<li>pValue - Measurement of statistical significance (-log10). Use -1
if no pValue is assigned.</li>
<li>qValue - Measurement of statistical significance using false
discovery rate (-log10). Use -1 if no qValue is assigned.</li>
<li>peak - Point-source called for this peak; 0-based offset from
chromStart. Use -1 if no point-source called.</li>
</ol>
<h2 id="column-headings">column headings</h2>
<p>æ¯ä¸ªåˆ—ä»£è¡¨çš„å«ä¹‰å¦‚ä¸‹:</p>
<table>
<thead>
<tr>
<th>Column</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>CHROM</td>
</tr>
<tr>
<td>1</td>
<td>CHROMSTART</td>
</tr>
<tr>
<td>2</td>
<td>CHROMEND</td>
</tr>
<tr>
<td>3</td>
<td>NAME</td>
</tr>
<tr>
<td>4</td>
<td>SCORE</td>
</tr>
<tr>
<td>5</td>
<td>STRAND</td>
</tr>
<tr>
<td>6</td>
<td>SIGNALVALUE</td>
</tr>
<tr>
<td>7</td>
<td>PVALUE</td>
</tr>
<tr>
<td>8</td>
<td>QVALUE</td>
</tr>
<tr>
<td>9</td>
<td>PEAK</td>
</tr>
</tbody>
</table>
<p>ä¸‹é¢æˆ‘ä»¬æ‰“å¼€ä¸€ä¸ªBEDæ–‡ä»¶.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># module for handling gzip formatted files.</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">gzip</span>
</span></span><span class="line"><span class="cl"><span class="n">RBFOX2_HepG2_filename</span> <span class="o">=</span> <span class="s1">&#39;ENCFF014SMJ_RBFOX2_HepG2_ChIP-seq-chr21.bed.gz&#39;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># What is the minimum and maximum signal values for this file</span>
</span></span><span class="line"><span class="cl"><span class="n">max_value</span> <span class="o">=</span> <span class="mf">0.0</span>
</span></span><span class="line"><span class="cl"><span class="n">min_value</span> <span class="o">=</span> <span class="mf">1.0e6</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">max_value</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">min_value</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>0.0
1000000.0
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">file</span> <span class="o">=</span> <span class="n">gzip</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">RBFOX2_HepG2_filename</span><span class="p">,</span> <span class="s1">&#39;rt&#39;</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">file</span><span class="p">))</span>
</span></span></code></pre></div><pre><code>&lt;_io.TextIOWrapper name='ENCFF014SMJ_RBFOX2_HepG2_ChIP-seq-chr21.bed.gz' encoding='cp936'&gt;
&lt;class '_io.TextIOWrapper'&gt;
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># for line in file:</span>
</span></span><span class="line"><span class="cl"><span class="c1">#     ols = line.rstrip(&#39;\n&#39;).split(&#39;\t&#39;)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#     print(ols)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">file</span><span class="p">),</span> <span class="mi">5</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">line</span> <span class="o">=</span> <span class="n">file</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">ols</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">ols</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span></code></pre></div><pre><code>---------------------------------------------------------------------------

TypeError                                 Traceback (most recent call last)

&lt;ipython-input-92-8900d0cb8c79&gt; in &lt;module&gt;
      3 #     print(ols)
      4 
----&gt; 5 for idx in range(0, len(file), 5):
      6     line = file[idx]
      7     ols = line.rstrip('\n').split('\t')


TypeError: object of type '_io.TextIOWrapper' has no len()
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># with gzip.open(RBFOX2_HepG2_filename, &#39;rt&#39;) as BED_FILE:</span>
</span></span><span class="line"><span class="cl"><span class="c1">#     for line in BED_FILE:</span>
</span></span><span class="line"><span class="cl"><span class="c1">#         cols = line.rstrip(&#39;\n&#39;).split(&#39;\t&#39;)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#         if float(cols[SIGNALVALUE]) &gt; max_value:</span>
</span></span><span class="line"><span class="cl"><span class="c1">#             max_value = float(cols[SIGNALVALUE])</span>
</span></span><span class="line"><span class="cl"><span class="c1">#         if float(cols[SIGNALVALUE]) &lt; min_value:</span>
</span></span><span class="line"><span class="cl"><span class="c1">#             min_value = float(cols[SIGNALVALUE])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># print(&#39;min =&#39;, min_value, &#39;max =&#39;, max_value)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="n">gzip</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">RBFOX2_HepG2_filename</span><span class="p">,</span> <span class="s1">&#39;rt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">BED_FILE</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">BED_FILE</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">cols</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">cols</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">max_value</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">max_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">cols</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">cols</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">min_value</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">min_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">cols</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;min =&#39;</span><span class="p">,</span> <span class="n">min_value</span><span class="p">,</span> <span class="s1">&#39;max =&#39;</span><span class="p">,</span> <span class="n">max_value</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>min = 2.00053908793031 max = 231.272535106579
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
</span></span></code></pre></div><pre><code>'D:\\my github\\shen\\content\\en\\post\\2019-12-02-python-for-genomics-class_day05'
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">()</span>
</span></span></code></pre></div><pre><code>['.ipynb_checkpoints',
 'ENCFF014SMJ_RBFOX2_HepG2_ChIP-seq-chr21.bed.gz',
 'ENCFF733YBM-trunc.fastq',
 'fastq.png',
 'featured.png',
 'index.ipynb']
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"></code></pre></div>
    </div>

    







<div class="share-box">
  <ul class="share">
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fjaspershen.github.io%2Fpost%2F2019-12-02-python-for-genomics-class_day05%2F&amp;text=Python&#43;for&#43;genomics&#43;day&#43;05" target="_blank" rel="noopener" class="share-btn-twitter" aria-label="twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fjaspershen.github.io%2Fpost%2F2019-12-02-python-for-genomics-class_day05%2F&amp;t=Python&#43;for&#43;genomics&#43;day&#43;05" target="_blank" rel="noopener" class="share-btn-facebook" aria-label="facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
        
      
      <li>
        <a href="mailto:?subject=Python%20for%20genomics%20day%2005&amp;body=https%3A%2F%2Fjaspershen.github.io%2Fpost%2F2019-12-02-python-for-genomics-class_day05%2F" target="_blank" rel="noopener" class="share-btn-email" aria-label="envelope">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fjaspershen.github.io%2Fpost%2F2019-12-02-python-for-genomics-class_day05%2F&amp;title=Python&#43;for&#43;genomics&#43;day&#43;05" target="_blank" rel="noopener" class="share-btn-linkedin" aria-label="linkedin-in">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="whatsapp://send?text=Python&#43;for&#43;genomics&#43;day&#43;05%20https%3A%2F%2Fjaspershen.github.io%2Fpost%2F2019-12-02-python-for-genomics-class_day05%2F" target="_blank" rel="noopener" class="share-btn-whatsapp" aria-label="whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=https%3A%2F%2Fjaspershen.github.io%2Fpost%2F2019-12-02-python-for-genomics-class_day05%2F&amp;title=Python&#43;for&#43;genomics&#43;day&#43;05" target="_blank" rel="noopener" class="share-btn-weibo" aria-label="weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>











  
  
    



  
  
  
    
  
  
  
  <div class="media author-card content-widget-hr">
    
      
      <a href="https://jaspershen.github.io/"><img class="avatar mr-3 avatar-circle" src="/authors/admin/avatar_hu86242519a21313948ac7dc77e0a27da6_1568301_270x270_fill_q75_lanczos_center.jpg" alt="Xiaotao Shen"></a>
    

    <div class="media-body">
      <h5 class="card-title"><a href="https://jaspershen.github.io/">Xiaotao Shen</a></h5>
      <h6 class="card-subtitle">Postdoctoral Research Fellow</h6>
      <p class="card-text">Metabolomics, Multi-omics, Bioinformatics, Systems Biology.</p>
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="/#contact" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://twitter.com/GeorgeCushen" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://scholar.google.co.uk/citations?user=sIwtMXoAAAAJ" target="_blank" rel="noopener">
        <i class="fas fa-graduation-cap"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/gcushen" target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.linkedin.com/" target="_blank" rel="noopener">
        <i class="fab fa-linkedin"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="/uploads/resume.pdf" >
        <i class="ai ai-cv"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>


  
















  </div>
</article>
  </div>

  <div class="page-footer">
    
    
    <div class="container">
      <footer class="site-footer">

  












  
  
  
  
  













  
  
  

  
  
    
  
  
    
  

  

  
  <p class="powered-by copyright-license-text">
    Â© 2023 Xiaotao Shen
  </p>
  

  <p class="powered-by footer-license-icons">
    <a href="https://creativecommons.org/licenses/by-nc-nd/4.0" rel="noopener noreferrer" target="_blank" aria-label="Creative Commons">
      <i class="fab fa-creative-commons fa-2x" aria-hidden="true"></i>
      <i class="fab fa-creative-commons-by fa-2x" aria-hidden="true"></i>
      
        <i class="fab fa-creative-commons-nc fa-2x" aria-hidden="true"></i>
      
      
        <i class="fab fa-creative-commons-nd fa-2x" aria-hidden="true"></i>
      
    </a>
  </p>





  <p class="powered-by">
    
    
    
      
      
      
      
      
      
      Published with <a href="https://wowchemy.com/?utm_campaign=poweredby" target="_blank" rel="noopener">Wowchemy</a> â€” the free, <a href="https://github.com/wowchemy/wowchemy-hugo-themes" target="_blank" rel="noopener">open source</a> website builder that empowers creators.
    
  </p>
</footer>

    </div>
    
  </div>

  


<script src="/js/vendor-bundle.min.f64289d8217e08e3afcd597d60836062.js"></script>




  

  
  

  













  
  <script id="search-hit-fuse-template" type="text/x-template">
    <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
    </div>
  </script>
  
    <script src="https://cdn.jsdelivr.net/gh/krisk/Fuse@v3.2.1/dist/fuse.min.js" integrity="sha512-o38bmzBGX+hD3JHWUFCDA09btWaqrNmoJ3RXLlrysA7PP01Kgs4UlE4MhelE1v5dJR3+cxlR4qQlotsW7jKsnw==" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/gh/julmot/mark.js@8.11.1/dist/jquery.mark.min.js" integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin="anonymous"></script>
  












  
  
  
  
  
  
  







<script id="page-data" type="application/json">{"use_headroom":true}</script>



  <script src="/js/wowchemy-headroom.db4755770454eb63685f8de785c0a172.js" type="module"></script>









  
  


<script src="/en/js/wowchemy.min.ead4a376bcf2c4714888c770ea9b0040.js"></script>







  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        
        <pre><code></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>


  <script src="/js/wowchemy-publication.68f8d7090562ca65fc6d3cb3f8f2d2cb.js" type="module"></script>


















</body>
</html>
